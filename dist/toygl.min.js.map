{"version":3,"file":"toygl.min.js","sources":["../src/defaultValue.js","../src/createContext.js","../src/defined.js","../src/glUtils.js","../src/setState.js","../src/WebglConstant.js","../src/createFramebuffer.js","../src/isPowerOfTwo.js","../src/buffer.js","../src/createVAO.js","../src/draw.js","../src/index.js","../src/getState.js","../src/clear.js","../src/isArrayLike.js","../src/createTexture.js","../src/updateTexture.js","../src/createCubeMap.js"],"sourcesContent":["function defaultValue(a, b) {\r\n  if (a === null || a === undefined) {\r\n    return b;\r\n  }\r\n  return a;\r\n}\r\n\r\ndefaultValue.EMPTY_OBJECT = Object.freeze({});\r\n\r\nexport default defaultValue;\r\n","import defaultValue from './defaultValue.js';\r\n\r\nconst global = window;\r\n\r\n/**\r\n * Create an instance of WebGLRenderingContext or WebGL2RenderingContext.\r\n * @param {Object} contextOptions \r\n * @param {Boolean} contextOptions.alpha \r\n * @param {Boolean} contextOptions.depth \r\n * @param {Boolean} contextOptions.stencil \r\n * @param {Boolean} contextOptions.antialias \r\n * @param {Boolean} contextOptions.preserveDrawingBuffer \r\n * @param {Boolean} contextOptions.premultipliedAlpha \r\n * @param {Boolean} contextOptions.requireWebgl2 \r\n * @param {HTMLCanvasElement} contextOptions.canvas \r\n * @returns \r\n */\r\nfunction createContext(contextOptions) {\r\n  contextOptions = defaultValue(contextOptions, defaultValue.EMPTY_OBJECT);\r\n\r\n  let canvas = contextOptions.canvas;\r\n  if (!canvas) {\r\n    canvas = global.document.createElement('canvas');\r\n    canvas.style.width = '100vw';\r\n    canvas.style.height = '100vh';\r\n    canvas.style.setProperty('display', 'block');\r\n    canvas.width = window.innerWidth;\r\n    canvas.height = window.innerHeight;\r\n  }\r\n\r\n  let gl;\r\n  if (contextOptions.requireWebgl2) {\r\n    gl = canvas.getContext('webgl2', contextOptions);\r\n  } else {\r\n    gl = canvas.getContext('webgl', contextOptions);\r\n  }\r\n\r\n  // VAO extension\r\n  if (!gl.createVertexArray) {\r\n    const extVAO = gl.getExtension('OES_vertex_array_object');\r\n    if (extVAO) {\r\n      gl.createVertexArray = extVAO.createVertexArrayOES.bind(extVAO);\r\n      gl.bindVertexArray = extVAO.bindVertexArrayOES.bind(extVAO);\r\n      gl.deleteVertexArray = extVAO.deleteVertexArrayOES.bind(extVAO);\r\n      gl.isVertexArray = extVAO.isVertexArrayOES.bind(extVAO);\r\n      gl.VERTEX_ARRAY_BINDING = extVAO.VERTEX_ARRAY_BINDING_OES;\r\n    }\r\n  }\r\n\r\n  // Instanced Array extension\r\n  if (!gl.drawArraysInstanced) {\r\n    const extInstancedArrays = gl.getExtension('ANGLE_instanced_arrays');\r\n    if (extInstancedArrays) {\r\n      gl.drawArraysInstanced = extInstancedArrays.drawArraysInstancedANGLE.bind(extInstancedArrays);\r\n      gl.drawElementsInstanced = extInstancedArrays.drawElementsInstancedANGLE.bind(extInstancedArrays);\r\n      gl.vertexAttribDivisor = extInstancedArrays.vertexAttribDivisorANGLE.bind(extInstancedArrays);\r\n      gl.VERTEX_ATTRIB_ARRAY_DIVISOR = extInstancedArrays.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE;\r\n    }\r\n  }\r\n\r\n  // Draw Buffers extension\r\n  if (!gl.drawBuffers) {\r\n    const extDrawBuffers = gl.getExtension('WEBGL_draw_buffers');\r\n    if (extDrawBuffers) {\r\n      gl.drawBuffers = extDrawBuffers.drawBuffersWEBGL.bind(extDrawBuffers);\r\n      for (let i = 1; i <= 15; i++) {\r\n        gl[`COLOR_ATTACHMENT${i}`] = extDrawBuffers[`COLOR_ATTACHMENT${i}_WEBGL`];\r\n        gl[`DRAW_BUFFER${i}`] = extDrawBuffers[`DRAW_BUFFER${i}_WEBGL`];\r\n      }\r\n\r\n      gl.MAX_COLOR_ATTACHMENTS = extDrawBuffers.MAX_COLOR_ATTACHMENTS_WEBGL;\r\n      gl.MAX_DRAW_BUFFERS = extDrawBuffers.MAX_DRAW_BUFFERS_WEBGL;\r\n      gl.MAX_DRAW_BUFFERS = extDrawBuffers.MAX_DRAW_BUFFERS_WEBGL;\r\n    }\r\n  }\r\n\r\n  // Texture Anisotropic Filter\r\n  if (!gl.MAX_TEXTURE_MAX_ANISOTROPY) {\r\n    const extTextureFilterAnisotropic = gl.getExtension('EXT_texture_filter_anisotropic');\r\n    if (extTextureFilterAnisotropic) {\r\n      gl.MAX_TEXTURE_MAX_ANISOTROPY = extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT;\r\n      gl.TEXTURE_MAX_ANISOTROPY = extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT;\r\n    }\r\n  }\r\n\r\n  if (!gl.MIN) {\r\n    const extBlendMinmax = gl.getExtension('EXT_blend_minmax');\r\n    if (extBlendMinmax) {\r\n      gl.MIN = extBlendMinmax.MIN_EXT;\r\n      gl.MAX = extBlendMinmax.MAX_EXT;\r\n    }\r\n  }\r\n\r\n  if (!gl.FRAGMENT_SHADER_DERIVATIVE_HINT) {\r\n    const extStandardDerivatives = gl.getExtension('OES_standard_derivatives');\r\n    if (extStandardDerivatives) {\r\n      gl.FRAGMENT_SHADER_DERIVATIVE_HINT = extStandardDerivatives.FRAGMENT_SHADER_DERIVATIVE_HINT_OES;\r\n    }\r\n  }\r\n\r\n  if (!gl.UNSIGNED_INT_24_8) {\r\n    const extDepthTexture = gl.getExtension('WEBGL_depth_texture');\r\n    if (extDepthTexture) {\r\n      gl.UNSIGNED_INT_24_8 = extDepthTexture.UNSIGNED_INT_24_8_WEBGL;\r\n    }\r\n  }\r\n\r\n  if (!gl.HALF_FLOAT) {\r\n    const extTextureHalfFloat = gl.getExtension('OES_texture_half_float');\r\n    if (extTextureHalfFloat) {\r\n      gl.HALF_FLOAT = extTextureHalfFloat.HALF_FLOAT_OES;\r\n    }\r\n  }\r\n\r\n  // texture compression\r\n  gl.extS3tc = gl.getExtension('WEBGL_compressed_texture_s3tc');\r\n  gl.extPvrtc = gl.getExtension('WEBGL_compressed_texture_pvrtc');\r\n  gl.extAstc = gl.getExtension('WEBGL_compressed_texture_astc');\r\n  gl.extEtc = gl.getExtension('WEBG_compressed_texture_etc');\r\n  gl.extEtc1 = gl.getExtension('WEBG_compressed_texture_etc1');\r\n  gl.extBc7 = gl.getExtension('EXT_texture_compression_bptc');\r\n\r\n  gl.extDebugShaders = gl.getExtension('WEBGL_debug_shaders');\r\n\r\n  gl._elementIndexUint = !!gl.getExtension('OES_element_index_uint');\r\n  gl._fragDepth = !!gl.getExtension('EXT_frag_depth');\r\n  gl._textureFloat = !!gl.getExtension('OES_texture_float');\r\n  gl._textureFloatLinear = !!gl.getExtension('OES_texture_float_linear');\r\n\r\n  gl._colorBufferFloat = !!gl.getExtension('EXT_color_buffer_float');\r\n  gl._colorBufferHalfFloat = !!gl.getExtension('EXT_color_buffer_half_float');\r\n  gl._floatBlend = !!gl.getExtension('EXT_float_blend');\r\n\r\n  gl._shaderTextureLod = !!gl.getExtension('EXT_shader_texture_lod');\r\n\r\n  return gl;\r\n}\r\n\r\nexport default createContext;\r\n","function defined(a) {\r\n  return a !== null && a !== undefined;\r\n}\r\n\r\nexport default defined;\r\n","import defined from \"./defined\";\r\n\r\nconst global = window;\r\n\r\n/**\r\n * Create a program and/or bind attribute location.\r\n * @param {WebGLRenderingContext} gl \r\n * @param {String} vertexShaderSource \r\n * @param {String} fragmentShaderSource \r\n * @param {Object} attributeLocations { [attributeName]: location }\r\n * @returns \r\n */\r\nfunction createProgram(gl, vertexShaderSource, fragmentShaderSource, attributeLocations) {\r\n  const vs = gl.createShader(gl.VERTEX_SHADER);\r\n  gl.shaderSource(vs, vertexShaderSource);\r\n  gl.compileShader(vs);\r\n  \r\n  const fs = gl.createShader(gl.FRAGMENT_SHADER);\r\n  gl.shaderSource(fs, fragmentShaderSource);\r\n  gl.compileShader(fs);\r\n\r\n  const program = gl.createProgram();\r\n  gl.attachShader(program, vs);\r\n  gl.attachShader(program, fs);\r\n\r\n  gl.deleteShader(vs);\r\n  gl.deleteShader(fs);\r\n\r\n  // bind attribute location\r\n  if (defined(attributeLocations)) {\r\n    for (const attributeName in attributeLocations) {\r\n      if (Object.hasOwnProperty.call(attributeLocations, attributeName)) {\r\n        const location = attributeLocations[attributeName];\r\n        gl.bindAttribLocation(program, location, attributeName);\r\n      }\r\n    }\r\n  }\r\n\r\n  gl.linkProgram(program);\r\n\r\n  let log = '';\r\n  if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {\r\n    if (!gl.getShaderParameter(fs, gl.COMPILE_STATUS)) {\r\n      log = gl.getShaderInfoLog(fs);\r\n      console.error('Fragment shader failed to compiled: ' + log);\r\n    }\r\n\r\n    if (!gl.getShaderParameter(vs, gl.COMPILE_STATUS)) {\r\n      log = gl.getShaderInfoLog(vs);\r\n      console.error('Vertex shader failed to compiled: ' + log);\r\n    }\r\n\r\n    log = gl.getProgramInfoLog(program);\r\n    console.error('Shader program link log: ' + log);\r\n  }\r\n\r\n  return program;\r\n}\r\n\r\nfunction setCanvasToDisplaySize(canvas) {\r\n  const dpr = global.devicePixelRatio;\r\n  const displayWidth = Math.round(canvas.clientWidth * dpr);\r\n  const displayHeight = Math.round(canvas.clientHeight * dpr);\r\n\r\n  const needResize = canvas.width !== displayWidth ||\r\n                     canvas.height !== displayHeight;\r\n\r\n  if (needResize) {\r\n    canvas.width = displayWidth;\r\n    canvas.height = displayHeight;\r\n  }\r\n}\r\n\r\nfunction validateStencilFunc(func) {\r\n  func = func.toUpperCase();\r\n  if (func === 'NEVER' ||\r\n    func === 'ALWAYS' ||\r\n    func === 'LESS' ||\r\n    func === 'LEQUAL' ||\r\n    func === 'NOTEQUAL' ||\r\n    func === 'EQUAL' ||\r\n    func === 'GREATER' ||\r\n    func === 'GEQUAL'\r\n  ) {\r\n    return true;\r\n  }\r\n  return false;\r\n}\r\n\r\nfunction validateStencilOp(op) {\r\n  op = op.toUpperCase();\r\n  if (op === 'KEEP' ||\r\n    op === 'ZERO' ||\r\n    op === 'REPLACE' ||\r\n    op === 'INCR' ||\r\n    op === 'DECR' ||\r\n    op === 'INVERT' ||\r\n    op === 'INCR_WRAP' ||\r\n    op === 'DECR_WRAP'\r\n  ) {\r\n    return true;\r\n  }\r\n  return false;\r\n}\r\n\r\nfunction validateGLConstantDefination(gl, constantName) {\r\n  const constant = gl[constantName];\r\n  if (!defined(constant)) {\r\n    throw new Error('gl.' + constantName + ' is not defined.');\r\n  }\r\n  return constant;\r\n}\r\n\r\nexport {\r\n  validateGLConstantDefination,\r\n  validateStencilFunc,\r\n  validateStencilOp,\r\n  createProgram,\r\n  setCanvasToDisplaySize,\r\n};\r\n","import defined from './defined.js';\r\nimport {\r\n  validateGLConstantDefination,\r\n  validateStencilFunc,\r\n  validateStencilOp,\r\n} from \"./glUtils.js\";\r\n\r\nfunction applyStencilStateSeparate(gl, face, state) {\r\n  if (defined(state.writeMask)) {\r\n    gl.stencilMaskSeparate(face, state.writeMask);\r\n  }\r\n\r\n  if (defined(state.func) &&\r\n    defined(state.ref) &&\r\n    defined(state.valueMask)\r\n  ) {\r\n    if (validateStencilFunc(state.func) === false) {\r\n      throw new Error('setState: stencil func is invalid, current is ' + state.func + '!');\r\n    }\r\n    const func = state.func.toUpperCase();\r\n    gl.stencilFuncSeparate(face, gl[func], state.ref, state.valueMask);\r\n  }\r\n\r\n  if (defined(state.fail) &&\r\n    defined(state.zfail) &&\r\n    defined(state.zpass)\r\n  ) {\r\n    if (validateStencilOp(state.fail) === false ||\r\n      validateStencilOp(state.zfail) === false ||\r\n      validateStencilOp(state.zpass) === false\r\n    ) {\r\n      throw new Error('setState: stencil op is invalid, current is ' + state.fail + ', ' + state.zfail + ', ' + state.zpass + '!');\r\n    }\r\n    const fail = state.fail.toUpperCase();\r\n    const zfail = state.zfail.toUpperCase();\r\n    const zpass = state.zpass.toUpperCase();\r\n    gl.stencilOpSeparate(face, gl[fail], gl[zfail], gl[zpass]);\r\n  }\r\n}\r\n\r\nexport default function setState(gl, state) {\r\n  const { depthTest, stencilTest, colorMask, cull, blend, viewport, scissor, polygonOffset, sampleCoverage, dither } = state;\r\n\r\n  if (cull) {\r\n    if (cull.enable) {\r\n      gl.enable(gl.CULL_FACE);\r\n    } else {\r\n      gl.disable(gl.CULL_FACE);\r\n    }\r\n\r\n    const face = cull.face && cull.face.toUpperCase();\r\n    if (face === 'BACK' || face === 'FRONT' || face === 'FRONT_AND_BACK') {\r\n      gl.cullFace(gl[face]);\r\n    }\r\n\r\n    let frontFace = defined(cull.frontFace) && cull.frontFace.toUpperCase();\r\n    if (frontFace === 'CCW' || frontFace === 'CW') {\r\n      gl.frontFace(gl[frontFace]);\r\n    }\r\n  }\r\n\r\n  if (depthTest) {\r\n    if (depthTest.enable === true) {\r\n      gl.enable(gl.DEPTH_TEST);\r\n    } else if (depthTest.enable === false) {\r\n      gl.disable(gl.DEPTH_TEST);\r\n    }\r\n\r\n    if (depthTest.func) {\r\n      const func = depthTest.func.toUpperCase();\r\n      gl.depthFunc(gl[func]);\r\n    }\r\n\r\n    if (depthTest.write === true) {\r\n      gl.depthMask(true);\r\n    } else if (depthTest.write === false) {\r\n      gl.depthMask(false);\r\n    }\r\n  }\r\n\r\n  if (stencilTest) {\r\n    if (stencilTest.enable === true) {\r\n      gl.enable(gl.STENCIL_TEST);\r\n    } else if (stencilTest.enable === false) {\r\n      gl.disable(gl.STENCIL_TEST);\r\n    }\r\n\r\n    // pass = (ref & readMask) func (stencilValue & redMask)\r\n    // If the stencil test fails, the incoming fragment is discarded\r\n    // if (!pass)\r\n         // update stencilValue\r\n    //   stencilValue = failOp(ref, stencilValue) & writeMask\r\n    // else if zfail\r\n    //   zfailOp\r\n    // else if zpass\r\n    //   zpassOp \r\n    const { front, back } = stencilTest;\r\n    if (front) {\r\n      applyStencilStateSeparate(gl, gl.FRONT, front);\r\n    }\r\n    if (back) {\r\n      applyStencilStateSeparate(gl, gl.BACK, back);\r\n    }\r\n  }\r\n\r\n  if (colorMask) {\r\n    gl.colorMask(colorMask[0], colorMask[1], colorMask[2], colorMask[3]);\r\n  }\r\n\r\n  if (blend) {\r\n    if (blend.enable === true) {\r\n      gl.enable(gl.BLEND)\r\n    } else if (blend.enable === false) {\r\n      gl.disable(gl.BLEND)\r\n    }\r\n\r\n    if (blend.blendColor) {\r\n      gl.blendColor(...blend.blendColor);\r\n    }\r\n\r\n    if (blend.blendEquationSeparate) {\r\n      const { rgb, alpha } = blend.blendEquationSeparate;\r\n      if (!defined(rgb) || !defined(alpha)) {\r\n        throw new Error('To use blendEquationSeparate you MUST specify rgb and alpha.');\r\n      }\r\n      const RGB = rgb.toUpperCase();\r\n      const ALPHA = alpha.toUpperCase();\r\n\r\n      const glRGB = gl[RGB];\r\n      const glALPHA = gl[ALPHA];\r\n      if (!defined(glRGB)) {\r\n        throw new Error('gl.' + RGB + ' is undefined.');\r\n      }\r\n      if (!defined(glALPHA)) {\r\n        throw new Error('gl.' + ALPHA + ' is undefined.');\r\n      }\r\n\r\n      gl.blendEquationSeparate(glRGB, glALPHA);\r\n    } else if (blend.blendEquation) {\r\n      const equationName = blend.blendEquation.toUpperCase();\r\n      const equation = gl[equationName];\r\n      if (!defined(equation)) {\r\n        throw new Error(equationName + ' is invalid.');\r\n      }\r\n\r\n      gl.blendEquation(equation);\r\n    }\r\n\r\n    const blendFuncSeparate = blend.blendFuncSeparate;\r\n    if (defined(blendFuncSeparate)) {\r\n      const { srcRGB, dstRGB, srcAlpha, dstAlpha } = blendFuncSeparate;\r\n      if (!defined(srcRGB)) {\r\n        throw new Error('To use blendFuncSeparate you MUST specify srcRGB property.');\r\n      }\r\n      if (!defined(dstRGB)) {\r\n        throw new Error('To use blendFuncSeparate you MUST specify dstRGB property.');\r\n      }\r\n      if (!defined(srcAlpha)) {\r\n        throw new Error('To use blendFuncSeparate you MUST specify srcAlpha property.');\r\n      }\r\n      if (!defined(dstAlpha)) {\r\n        throw new Error('To use blendFuncSeparate you MUST specify dstAlpha property.');\r\n      }\r\n\r\n      const SRCRGB = srcRGB.toUpperCase();\r\n      const DSTRGB = dstRGB.toUpperCase();\r\n      const SRCALPHA = srcAlpha.toUpperCase();\r\n      const DSTALPHA = dstAlpha.toUpperCase();\r\n\r\n      const glSrcRGB = validateGLConstantDefination(gl, SRCRGB);\r\n      const glDstRGB = validateGLConstantDefination(gl, DSTRGB);\r\n      const glSrcAlpha = validateGLConstantDefination(gl, SRCALPHA);\r\n      const glDstAlpha = validateGLConstantDefination(gl, DSTALPHA);\r\n\r\n      gl.blendFuncSeparate(glSrcRGB, glDstRGB, glSrcAlpha, glDstAlpha);\r\n    } else if (defined(blend.blendFunc)) {\r\n      const srcFuncName = blend.blendFunc[0].toUpperCase();\r\n      const dstFuncName = blend.blendFunc[1].toUpperCase();\r\n      const src = validateGLConstantDefination(gl, srcFuncName);\r\n      const dst = validateGLConstantDefination(gl, dstFuncName);\r\n      gl.blendFunc(src, dst);\r\n    }\r\n  }\r\n\r\n  if (viewport) {\r\n    gl.viewport(viewport[0], viewport[1], viewport[2], viewport[3]);\r\n  }\r\n\r\n  if (scissor) {\r\n    if (scissor.enable === true) {\r\n      gl.enable(gl.SCISSOR_TEST);\r\n    } else if (scissor.enable === false) {\r\n      gl.disable(gl.SCISSOR_TEST);\r\n    }\r\n    const rect = scissor.rect;\r\n    if (rect) {\r\n      gl.scissor(rect[0], rect[1], rect[2], rect[3]);\r\n    }\r\n  }\r\n\r\n  // motivation: for render coplanar primitives\r\n  // https://www.opengl.org/archives/resources/faq/technical/polygonoffset.htm\r\n  if (defined(polygonOffset)) {\r\n    if (polygonOffset.enable === true) {\r\n      gl.enable(gl.POLYGON_OFFSET_FILL);\r\n    } else if (polygonOffset.enable === false) {\r\n      gl.disable(gl.POLYGON_OFFSET_FILL);\r\n    } else {\r\n      console.warn('polygonOffset.enable MUST be either true or false, current is ' + polygonOffset.enable.toString() + '.');\r\n    }\r\n    // Offset value: o = m * factor + r * units,\r\n    // where m is maximum depth slope of a triangle,\r\n    // r is minimum resolvable difference, which is an implementation-dependent constant.\r\n    gl.polygonOffset(polygonOffset.factor, polygonOffset.units);\r\n  }\r\n\r\n  if (defined(sampleCoverage)) {\r\n    const { alphaToCoverage, value, invert, enable } = sampleCoverage;\r\n\r\n    if (alphaToCoverage === true) {\r\n      gl.enable(gl.SAMPLE_ALPHA_TO_COVERAGE);\r\n    } else if (alphaToCoverage === false) {\r\n      gl.disable(gl.SAMPLE_ALPHA_TO_COVERAGE);\r\n    }\r\n\r\n    if (enable === true) {\r\n      gl.enable(gl.SAMPLE_COVERAGE);\r\n    } else if (enable === false) {\r\n      gl.disable(gl.SAMPLE_COVERAGE);\r\n    }\r\n\r\n    if (defined(value) && defined(invert)) {\r\n      if (invert !== true && invert !== false) {\r\n        console.warn('sampleCoverage.invert MUST be boolean.');\r\n      }\r\n      gl.sampleCoverage(value, invert);\r\n    }\r\n  }\r\n\r\n  if (defined(dither)) {\r\n    if (dither === true) {\r\n      gl.enable(gl.DITHER);\r\n    } else if (dither === false) {\r\n      gl.disable(gl.DITHER);\r\n    } else {\r\n      console.warn('setState: dither MUST be a boolean value, otherwise it will be ignored.');\r\n    }\r\n  }\r\n  \r\n}\r\n","const WebGLConstant = {\r\n  // ACTIVE_TEXTURE\r\n  34016: 'ACTIVE_TEXTURE',\r\n  33984: 'TEXTURE0',\r\n  33985: 'TEXTURE1',\r\n  33986: 'TEXTURE2',\r\n  33987: 'TEXTURE3',\r\n  33988: 'TEXTURE4',\r\n  33989: 'TEXTURE5',\r\n  33990: 'TEXTURE6',\r\n  33991: 'TEXTURE7',\r\n  33992: 'TEXTURE8',\r\n  33993: 'TEXTURE9',\r\n  33994: 'TEXTURE10',\r\n  33995: 'TEXTURE11',\r\n  33996: 'TEXTURE12',\r\n  33997: 'TEXTURE13',\r\n  33998: 'TEXTURE14',\r\n  33999: 'TEXTURE15',\r\n  34000: 'TEXTURE16',\r\n  34001: 'TEXTURE17',\r\n  34002: 'TEXTURE18',\r\n  34003: 'TEXTURE19',\r\n  34004: 'TEXTURE20',\r\n  34005: 'TEXTURE21',\r\n  34006: 'TEXTURE22',\r\n  34007: 'TEXTURE23',\r\n  34008: 'TEXTURE24',\r\n  34009: 'TEXTURE25',\r\n  34010: 'TEXTURE26',\r\n  34011: 'TEXTURE27',\r\n  34012: 'TEXTURE28',\r\n  34013: 'TEXTURE29',\r\n  34014: 'TEXTURE30',\r\n  34015: 'TEXTURE31',\r\n\r\n  3410: 'RED_BITS',\r\n  3411: 'GREEN_BITS',\r\n  3412: 'BLUE_BITS',\r\n  3413: 'ALPHA_BITS',\r\n\r\n  2884: 'CULL_FACE',\r\n  // cullFace\r\n  2885: 'CULL_FACE_MODE',\r\n  1028: 'FRONT',\r\n  1029: 'BACK',\r\n  1032: 'FRONT_AND_BACK',\r\n\r\n  // depthFunc, stencilFunc\r\n  512: 'NEVER',\r\n  513: 'LESS',\r\n  514: 'EQUAL',\r\n  515: 'LEQUAL',\r\n  516: 'GREATER',\r\n  517: 'NOTEQUAL',\r\n  518: 'GEQUAL',\r\n  519: 'ALWAYS',\r\n\r\n  // stencilOp(fail, zfail, zpass)\r\n  // stencilOpSeparate(face, fail, zfail, zpass)\r\n  0: 'ZERO', // blendFunc\r\n  1: 'ONE',\r\n  5386: 'INVERT',\r\n  7680: 'KEEP',\r\n  7681: 'REPLACE',\r\n  7682: 'INCR',\r\n  7683: 'DECR',\r\n  34055: 'INCR_WRAP',\r\n  34056: 'DECR_WRAP',\r\n\r\n  // blendEquationSeparate\r\n  32774: 'FUNC_ADD',\r\n  32778: 'FUNC_SUBTRACT',\r\n  32779: 'FUNC_REVERSE_SUBTRACT',\r\n\r\n  // blendFuncSeparate\r\n  768: 'SRC_COLOR',\r\n  770: 'SRC_ALPHA',\r\n  774: 'DST_COLOR',\r\n  772: 'DST_ALPHA',\r\n  32769: 'CONSTANT_COLOR',\r\n  32771: 'CONSTANT_ALPHA',\r\n\r\n  769: 'ONE_MINUS_SRC_COLOR',\r\n  771: 'ONE_MINUS_SRC_ALPHA',\r\n  775: 'ONE_MINUS_DST_COLOR',\r\n  773: 'ONE_MINUS_DST_ALPHA',\r\n  32770: 'ONE_MINUS_CONSTANT_COLOR',\r\n  32772: 'ONE_MINUS_CONSTANT_ALPHA',\r\n\r\n  // FRONT_FACE\r\n  2304: 'CW',\r\n  2305: 'CCW',\r\n\r\n  // hint\r\n  4352: 'DONT_CARE',\r\n  4353: 'FASTEST',\r\n  4354: 'NICEST',\r\n\r\n  // WEBGL_compressed_texture_s3tc\r\n  33776: 'COMPRESSED_RGB_S3TC_DXT1_EXT',\r\n  33777: 'COMPRESSED_RGBA_S3TC_DXT1_EXT',\r\n  33778: 'COMPRESSED_RGBA_S3TC_DXT3_EXT',\r\n  33779: 'COMPRESSED_RGBA_S3TC_DXT5_EXT',\r\n  // EXT_texture_compression_bptc\r\n  36492: 'COMPRESSED_RGBA_BPTC_UNORM_EXT',\r\n  36493: 'COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT',\r\n  36494: 'COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT',\r\n  36495: 'COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT',\r\n  // EXT_texture_compression_rgtc\r\n  36283: 'COMPRESSED_RED_RGTC1_EXT',\r\n  36284: 'COMPRESSED_SIGNED_RED_RGTC1_EXT',\r\n  36285: 'COMPRESSED_RED_GREEN_RGTC2_EXT',\r\n  36286: 'COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT',\r\n\r\n  // UNPACK_COLORSPACE_CONVERSION_WEBGL\r\n  37444: 'BROWSER_DEFAULT_WEBGL',\r\n\r\n  BYTE: 0x1400,\r\n  UNSIGNED_BYTE: 0x1401,\r\n  SHORT: 0x1402,\r\n  UNSIGNED_SHORT: 0x1403,\r\n  INT: 0x1404,\r\n  UNSIGNED_INT: 0x1405,\r\n  FLOAT: 0x1406,\r\n};\r\n\r\nexport default WebGLConstant;\r\n","import defaultValue from './defaultValue.js';\r\n\r\nconst FRAMEBUFFER_STATUS = {\r\n  36053: 'FRAMEBUFFER_COMPLETE',\r\n  36054: 'FRAMEBUFFER_INCOMPLETE_ATTACHMENT',\r\n  36055: 'FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT',\r\n  36057: 'FRAMEBUFFER_INCOMPLETE_DIMENSIONS',\r\n  36061: 'FRAMEBUFFER_UNSUPPORTED',\r\n};\r\n\r\nfunction createFramebuffer(gl, options) {\r\n  const { colorTexture, depthTexture, depthRenderbuffer } = options;\r\n  const colorAttachments = defaultValue(options.colorAttachments, [ colorTexture ])\r\n\r\n  const fb = gl.createFramebuffer();\r\n  gl.bindFramebuffer(gl.FRAMEBUFFER, fb);\r\n\r\n  // color\r\n  gl.activeTexture(gl.TEXTURE0);\r\n  const colorAttachmentsLength = colorAttachments.length;\r\n  if (colorAttachmentsLength > 1) {\r\n    const ext = gl.getExtension('WebGL_draw_buffers');\r\n    const drawBuffers = [];\r\n    for (let i = 0; i < colorAttachmentsLength; i++) {\r\n      drawBuffers.push(ext.COLOR_ATTACHMENT0_WEBGL + i);\r\n    }\r\n    ext.drawBuffersWEBGL(drawBuffers);\r\n\r\n    for (let i = 0; i < colorAttachmentsLength; i++) {\r\n      const colorAttachment = colorAttachments[i];\r\n      gl.bindTexture(gl.TEXTURE_2D, colorAttachment);\r\n      gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0 + i, gl.TEXTURE_2D, colorAttachment, 0);\r\n    }\r\n  } else {\r\n    gl.bindTexture(gl.TEXTURE_2D, colorTexture);\r\n    gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, colorTexture, 0);\r\n  }\r\n  gl.bindTexture(gl.TEXTURE_2D, null);\r\n\r\n  // depth\r\n  if (depthTexture) {\r\n    gl.bindTexture(gl.TEXTURE_2D, depthTexture);\r\n    gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.DEPTH_ATTACHMENT, gl.TEXTURE_2D, depthTexture, 0);\r\n    gl.bindTexture(gl.TEXTURE_2D, null);\r\n  }\r\n  else if (depthRenderbuffer) {\r\n    const renderbuffer = gl.createRenderbuffer();\r\n    gl.bindRenderbuffer(gl.RENDERBUFFER, renderbuffer);\r\n    gl.renderbufferStorage(gl.RENDERBUFFER, gl.DEPTH_COMPONENT16, depthRenderbuffer.width, depthRenderbuffer.height);\r\n    gl.framebufferRenderbuffer(gl.FRAMEBUFFER, gl.DEPTH_ATTACHMENT, gl.RENDERBUFFER, renderbuffer);\r\n    gl.bindRenderbuffer(gl.RENDERBUFFER, null);\r\n  }\r\n\r\n  const status = gl.checkFramebufferStatus(gl.FRAMEBUFFER);\r\n  if (status !== gl.FRAMEBUFFER_COMPLETE) {\r\n    throw new Error('createFramebuffer: framebuffer combination is NOT completed! Current status is ' + FRAMEBUFFER_STATUS[status] + '.');\r\n  }\r\n\r\n  return fb;\r\n}\r\n\r\nexport default createFramebuffer;\r\n","function isPowerOfTwo(value) {\r\n  return (value & (value - 1)) === 0;\r\n}\r\n\r\nexport default isPowerOfTwo;\r\n","import defaultValue from './defaultValue.js';\r\nimport WebglConstant from './WebglConstant.js';\r\n\r\nconst cachedBuffer = {};\r\n\r\nfunction isArrayBufferView(value) {\r\n  return value instanceof Float32Array ||\r\n         value instanceof Uint8Array ||\r\n         value instanceof Uint16Array ||\r\n         value instanceof Uint32Array ||\r\n         value instanceof Int8Array ||\r\n         value instanceof Int16Array ||\r\n         value instanceof Int32Array;\r\n}\r\n\r\nfunction getIndicesType(indices) {\r\n  let indicesType;\r\n  let max = indices[0];\r\n  for (let i = 1; i < indices.length; i++) {\r\n    max = Math.max(max, indices[i]);\r\n  }\r\n\r\n  if (max <= 255) {\r\n    indicesType = WebglConstant.UNSIGNED_BYTE;\r\n  } else if (max <= 65535) {\r\n    indicesType = WebglConstant.UNSIGNED_SHORT;\r\n  } else {\r\n    indicesType = WebglConstant.UNSIGNED_INT;\r\n  }\r\n\r\n  return indicesType;\r\n}\r\n\r\nfunction createBuffer(gl, bufferTarget, source, usage) {\r\n  const buffer = gl.createBuffer();\r\n  gl.bindBuffer(bufferTarget, buffer);\r\n  gl.bufferData(bufferTarget, source, usage);\r\n  gl.bindBuffer(bufferTarget, null);\r\n  return buffer;\r\n}\r\n\r\nfunction createAttributeBuffer(gl, typedArrayOrArray, usage) {\r\n  let bufferKey = '';\r\n  for (const element of typedArrayOrArray) {\r\n    if (bufferKey.length > 10e5) break;\r\n    bufferKey += `${element.toFixed(3)},`;\r\n  }\r\n  let buffer = cachedBuffer[bufferKey];\r\n  if (buffer) {\r\n    return buffer;\r\n  }\r\n\r\n  usage = defaultValue(usage, gl.STATIC_DRAW);\r\n\r\n  let typedArray;\r\n  if (Array.isArray(typedArrayOrArray)) {\r\n    typedArray = new Float32Array(typedArrayOrArray);\r\n  } else if (isArrayBufferView(typedArrayOrArray)) {\r\n    typedArray = typedArrayOrArray;\r\n  } else {\r\n    throw new Error('Buffer data' + typedArrayOrArray + 'must be TypedArray or Array ');\r\n  }\r\n\r\n  buffer = createBuffer(gl, gl.ARRAY_BUFFER, typedArray, usage)\r\n  cachedBuffer[bufferKey] = buffer;\r\n  return buffer;\r\n}\r\n\r\nfunction createIndicesBuffer(gl, typedArrayOrArray, usage) {\r\n  const bufferKey = typedArrayOrArray.toString();\r\n  let buffer = cachedBuffer[bufferKey];\r\n  if (buffer) {\r\n    return buffer;\r\n  }\r\n\r\n  usage = defaultValue(usage, gl.STATIC_DRAW);\r\n\r\n  let typedArray;\r\n  const indicesType = getIndicesType(typedArrayOrArray);\r\n\r\n  if (indicesType === gl.UNSIGNED_BYTE) {\r\n\r\n    typedArray = new Uint8Array(typedArrayOrArray);\r\n\r\n  } else if (indicesType === gl.UNSIGNED_SHORT) {\r\n\r\n    typedArray = new Uint16Array(typedArrayOrArray);\r\n\r\n  } else if (indicesType === gl.UNSIGNED_INT) {\r\n\r\n    typedArray = new Uint32Array(typedArrayOrArray);\r\n    gl.getExtension('OES_element_index_unit');\r\n\r\n  } else {\r\n    throw new Error('Buffer data must be TypedArray or Array ');\r\n  }\r\n\r\n  buffer = createBuffer(gl, gl.ELEMENT_ARRAY_BUFFER, typedArray, usage);\r\n  // Store index buffer data type\r\n  buffer.indicesType = indicesType;\r\n  cachedBuffer[bufferKey] = buffer;\r\n  return buffer;\r\n}\r\n\r\nexport {\r\n  cachedBuffer,\r\n  createAttributeBuffer,\r\n  createIndicesBuffer,\r\n  getIndicesType,\r\n};\r\n","import { createAttributeBuffer, createIndicesBuffer } from './buffer.js';\r\nimport defined from './defined.js';\r\n\r\n/**\r\n * Create a vertex array object. You can imagine it like this\r\n * <pre>\r\n * var glState = {\r\n *   attributeState: {\r\n *     ELEMENT_ARRAY_BUFFER: null,\r\n *     attributes: [\r\n *       { enable: ?, size: ?, type: ?, normalize: ?, stride: ?, offset: ?, buffer: ?, },\r\n *       { enable: ?, size: ?, type: ?, normalize: ?, stride: ?, offset: ?, buffer: ?, },\r\n *       { enable: ?, size: ?, type: ?, normalize: ?, stride: ?, offset: ?, buffer: ?, },\r\n *       { enable: ?, size: ?, type: ?, normalize: ?, stride: ?, offset: ?, buffer: ?, },\r\n *       { enable: ?, size: ?, type: ?, normalize: ?, stride: ?, offset: ?, buffer: ?, },\r\n *       { enable: ?, size: ?, type: ?, normalize: ?, stride: ?, offset: ?, buffer: ?, },\r\n *       { enable: ?, size: ?, type: ?, normalize: ?, stride: ?, offset: ?, buffer: ?, },\r\n *       { enable: ?, size: ?, type: ?, normalize: ?, stride: ?, offset: ?, buffer: ?, },\r\n *     ],\r\n *   },\r\n * </pre>\r\n * @param {WebGLRenderingContext|WebGL2RenderingContext} gl \r\n * @param {Object} options \r\n * @param {Object} options.attributes The key of Object is vertex attribute name, value is a Object, it includes <code>location</code>, <code>size</code> and <code>data</code> property, for example:\r\n * <pre>\r\n * {\r\n *   a_pos: {\r\n *     location: 0,\r\n *     size: 3,\r\n *     data: [\r\n *       0, 0, 0,\r\n *       1, 1, 1,\r\n *       0, 1, 0,\r\n *     ]\r\n *   }\r\n * }\r\n * </pre>\r\n * @param {Object} options.indices ELEMENT_ARRAY_BUFFER of vertex array.\r\n * @returns {WebGLVertexArrayObjectOES}\r\n */\r\nfunction createVAO(gl, options) {\r\n  if (!gl.createVertexArray) return undefined;\r\n\r\n  const oldVao = gl.getParameter(gl.VERTEX_ARRAY_BINDING);\r\n\r\n  const vao = gl.createVertexArray();\r\n  gl.bindVertexArray(vao);\r\n\r\n  const attributes = options.attributes;\r\n  const indices = options.indices;\r\n\r\n  for (const attributeName in attributes) {\r\n    if (Object.hasOwnProperty.call(attributes, attributeName)) {\r\n      const { location, data, size } = attributes[attributeName];\r\n\r\n      const buffer = createAttributeBuffer(gl, data, gl.STATIC_DRAW);\r\n\r\n      gl.bindBuffer(gl.ARRAY_BUFFER, buffer);\r\n      gl.enableVertexAttribArray(location);\r\n\r\n      // TODO: expose attribute data type\r\n      const type = gl.FLOAT;\r\n      const normalized = false;\r\n      const stride = 0;\r\n      const offset = 0;\r\n      gl.vertexAttribPointer(location, size, type, normalized, stride, offset);\r\n    }\r\n  }\r\n\r\n  if (defined(indices)) {\r\n    const indicesBuffer = createIndicesBuffer(gl, indices, gl.STATIC_DRAW);\r\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, indicesBuffer);\r\n  }\r\n\r\n  gl.bindVertexArray(oldVao);\r\n\r\n  return vao;\r\n}\r\n\r\nexport default createVAO;","import isArrayLike from './isArrayLike.js';\r\nimport defaultValue from './defaultValue.js';\r\nimport {\r\n  createProgram,\r\n} from './glUtils.js';\r\nimport defined from './defined.js';\r\nimport {\r\n  createIndicesBuffer,\r\n  getIndicesType,\r\n} from './buffer.js';\r\nimport createVAO from './createVAO.js';\r\n\r\nconst cachedProgram = {};\r\nconst cachedTextures = {};\r\n\r\nfunction getNumberOfComponentsByType(type) {\r\n  let numberOfComponents = 0;\r\n\r\n  switch (type) {\r\n  case 5126: // FLOAT\r\n    numberOfComponents = 1;\r\n    break;\r\n  case 35664: // FLOAT_VEC2\r\n    numberOfComponents = 2;\r\n    break;\r\n  case 35665: // gl.FLOAT_VEC3\r\n    numberOfComponents = 3;\r\n    break;\r\n  case 35666: // FLOAT_VEC4\r\n    numberOfComponents = 4;\r\n    break;\r\n  case 35674: // FLOAT_MAT2\r\n    numberOfComponents = 4;\r\n    break;\r\n  case 35675: // FLOAT_MAT3\r\n    numberOfComponents = 9;\r\n    break;\r\n  case 35676: // FLOAT_MAT4\r\n    numberOfComponents = 16;\r\n    break;\r\n  default:\r\n    throw new Error('Unrecognize ' + type + ' type.');\r\n  }\r\n  return numberOfComponents;\r\n}\r\n\r\nfunction getAttributeSize(activeAttribute) {\r\n  const { name, size, type } = activeAttribute;\r\n  const componentCount = getNumberOfComponentsByType(type);\r\n  return size * componentCount;\r\n}\r\n\r\nconst vaoCache = {};\r\nfunction getVaoKey(attributes, indices) {\r\n  let key = '';\r\n  for (const attributeName in attributes) {\r\n    if (Object.hasOwnProperty.call(attributes, attributeName)) {\r\n      const attribute = attributes[attributeName];\r\n      key += attribute.toString();\r\n    }\r\n  }\r\n\r\n  if (indices) {\r\n    key += indices.toString();\r\n  }\r\n\r\n  return key;\r\n}\r\n\r\n/**\r\n * Execute a draw command.\r\n * @param {WebGLRenderingContext|WebGL2RenderingContext} gl \r\n * @param {Object} options \r\n * @param {String} options.vs Vertex shader text\r\n * @param {String} options.fs Fragment shader text\r\n * @param {Object} [options.attributes] use <code>attributes</code> or <code>vao</code> property.\r\n * @param {WebGLVertexArrayObjectOES} [options.vao] @see {@link createVAO}\r\n * @param {Object} [options.attributeLocations] If you define <code>vao</code> property, in order to correspond to attribute location of VAO, you must specify the location for the vertex attribute of shader program.\r\n * @param {Object} [options.uniforms] The key of object is uniform name, value can be string(texture image file path), number, Array, ArrayBufferView. Uniform array is supported.\r\n * @param {Array | Uint8Array | Uint16Array | Uint32Array} [options.indices] Vertex indices, when using an Array, it is treated as Uint16Array, so if the maximum value of indices is greater then 65535, Uint32Array MUST be used.\r\n * @param {Number} [options.count=indices.length] The number of vertices.\r\n * @param {Number} [options.primitiveType=gl.TRIANGLES] Primitive type. <code>gl.LINES</code>, <code>gl.POINTS</code>.\r\n * @param {WebGLFramebuffer | null} [options.fb=null] See {@link createFramebuffer}.\r\n */\r\nfunction draw(gl, options) {\r\n  const {\r\n    attributes,\r\n    indices,\r\n    vao,\r\n    vs: vsSource,\r\n    fs: fsSource,\r\n    attributeLocations,\r\n    fb\r\n  } = options;\r\n\r\n  let count = options.count;\r\n  if (!defined(count) && defined(indices)) {\r\n    count = indices.length;\r\n  }\r\n  if (!defined(count)) {\r\n    throw new Error('vertices count or indices is not defined.');\r\n  }\r\n\r\n  if (defined(vao) && !defined(attributeLocations)) {\r\n    throw new Error('To use vao, you must defined attributeLocations.');\r\n  }\r\n\r\n  const primitiveType = defaultValue(options.primitiveType, gl.TRIANGLES);\r\n  const uniforms = defaultValue(options.uniforms, defaultValue.EMPTY_OBJECT);\r\n\r\n  gl.bindFramebuffer(gl.FRAMEBUFFER, fb);\r\n\r\n  const key = vsSource + fsSource;\r\n  let program = cachedProgram[key];\r\n  if (!program) {\r\n    program = createProgram(gl, vsSource, fsSource, attributeLocations);\r\n    cachedProgram[key] = program;\r\n  }\r\n\r\n  gl.useProgram(program);\r\n\r\n  // attributes\r\n  const numberOfAttributes = gl.getProgramParameter(program, gl.ACTIVE_ATTRIBUTES);\r\n\r\n  if (defined(vao)) {\r\n\r\n    gl.bindVertexArray(vao);\r\n\r\n  } else if (defined(attributes)) {\r\n    const vaoKey = getVaoKey(attributes, indices);\r\n    let vao = vaoCache[vaoKey];\r\n    if (!vao) {\r\n      const vaoAttributes = {};\r\n      for (let i = 0; i < numberOfAttributes; i++) {\r\n        const activeAttribute = gl.getActiveAttrib(program, i);\r\n        const attributeName = activeAttribute.name;\r\n\r\n        if (Object.hasOwnProperty.call(attributes, attributeName)) {\r\n          const attribute = attributes[attributeName];\r\n          const attribLocation = gl.getAttribLocation(program, attributeName);\r\n  \r\n          if (attribLocation === -1) {\r\n            continue;\r\n          }\r\n\r\n          const size = getAttributeSize(activeAttribute);\r\n          vaoAttributes[attributeName] = {\r\n            location: attribLocation,\r\n            size: size,\r\n            data: attribute,\r\n          };\r\n        }\r\n      }\r\n\r\n      vao = createVAO(gl, {\r\n        attributes: vaoAttributes,\r\n        indices: indices,\r\n      });\r\n\r\n      vaoCache[vaoKey] = vao;\r\n    }\r\n\r\n    gl.bindVertexArray(vao);\r\n  } else {\r\n    throw new Error('vao or attributes must be defined.');\r\n  }\r\n\r\n  // uniforms\r\n  const numberOfUniforms = gl.getProgramParameter(program, gl.ACTIVE_UNIFORMS);\r\n  const maximumTextureUnits = gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS);\r\n  let currentTextureUnit = 0;\r\n  for (let i = 0; i < numberOfUniforms; i++) {\r\n    const activeUniform = gl.getActiveUniform(program, i);\r\n    let uniformName = activeUniform.name;\r\n    const type = activeUniform.type;\r\n    let isUniformArray = false;\r\n\r\n    const indexOfBracket = uniformName.indexOf('[');\r\n    if (indexOfBracket >= 0) {\r\n      // \"u_xxx[0]\" => \"u_xxx\"\r\n      uniformName = uniformName.slice(0, indexOfBracket);\r\n      isUniformArray = true;\r\n    }\r\n    \r\n    if (Object.hasOwnProperty.call(uniforms, uniformName)) {\r\n      const uniform = uniforms[uniformName];\r\n      const uniformLocation = gl.getUniformLocation(program, uniformName);\r\n\r\n      if (uniformLocation === null) {\r\n        continue;\r\n      }\r\n\r\n      // support float, vec[234] uniform array\r\n      if (isUniformArray) {\r\n        const numberOfComponents = getNumberOfComponentsByType(type);\r\n\r\n        gl['uniform' + numberOfComponents + 'fv'](uniformLocation, Array.from(uniform));\r\n        continue;\r\n      }\r\n\r\n      const typeOfUniform = typeof uniform;\r\n      const textureUnit = gl.TEXTURE0 + currentTextureUnit;\r\n      if (uniform instanceof WebGLTexture) {\r\n        gl.activeTexture(textureUnit);\r\n\r\n        if (activeUniform.type === gl.SAMPLER_2D) {\r\n          gl.bindTexture(gl.TEXTURE_2D, uniform);\r\n        } else if (activeUniform.type === gl.SAMPLER_3D) {\r\n          gl.bindTexture(gl.TEXTURE_3D, uniform);\r\n        } else if (activeUniform.type === gl.SAMPLER_CUBE) {\r\n          gl.bindTexture(gl.TEXTURE_CUBE_MAP, uniform);\r\n        } else {\r\n          throw new Error(activeUniform, 'type MUST be SAMPLER_2D or SAMPLER_CUBE');\r\n        }\r\n\r\n        gl.uniform1i(uniformLocation, currentTextureUnit);\r\n        currentTextureUnit++;\r\n      } else if (isArrayLike(uniform)) {\r\n        const size = uniform.length;\r\n        if (size <= 4) {\r\n          gl['uniform' + size + 'fv' ](uniformLocation, uniform);\r\n        } else if (size <= 16) {\r\n          const order = Math.floor(Math.sqrt(size));\r\n          const transpose = false; // MUST be false\r\n          gl['uniformMatrix' + order + 'fv'](uniformLocation, transpose, Array.from(uniform));\r\n        }\r\n      } else if (type === gl.FLOAT /*typeOfUniform === 'number'*/) {\r\n        gl.uniform1f(uniformLocation, uniform);\r\n      } else if (type === gl.BOOL || type === gl.INT) {\r\n        gl.uniform1i(uniformLocation, uniform);\r\n      } else if (typeOfUniform === 'string') {\r\n\r\n        if (currentTextureUnit > maximumTextureUnits) {\r\n          console.error('texture exceed maximum texture units.');\r\n          continue;\r\n        }\r\n\r\n        let texture = cachedTextures[uniform];\r\n\r\n        if (!texture) {\r\n          texture = gl.createTexture();\r\n          gl.activeTexture(textureUnit);\r\n          gl.bindTexture(gl.TEXTURE_2D, texture);\r\n\r\n          gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n          gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n          gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\r\n          gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\r\n\r\n          gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, 1, 1, 0, gl.RGBA, gl.UNSIGNED_BYTE, new Uint8Array([255, 255, 255, 255]));\r\n          const image = new Image();\r\n          image.src = uniform;\r\n          image.addEventListener('load', () => {\r\n            gl.activeTexture(textureUnit);\r\n            gl.bindTexture(gl.TEXTURE_2D, texture);\r\n            gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, image);\r\n          });\r\n\r\n          cachedTextures[uniform] = texture;\r\n        }\r\n\r\n        gl.activeTexture(textureUnit);\r\n        gl.bindTexture(gl.TEXTURE_2D, texture);\r\n        gl.uniform1i(uniformLocation, currentTextureUnit);\r\n\r\n        currentTextureUnit++;\r\n      }\r\n    }\r\n  }\r\n\r\n  // draw\r\n  const hasBoundElementArrayBuffer = gl.getParameter(gl.ELEMENT_ARRAY_BUFFER_BINDING);\r\n  if (indices && indices.length > 0) {\r\n    const buffer = createIndicesBuffer(gl, indices, gl.STATIC_DRAW);\r\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, buffer);\r\n\r\n    const indicesType = getIndicesType(indices);\r\n    gl.drawElements(primitiveType, count, indicesType, 0);\r\n  } else if (hasBoundElementArrayBuffer) {\r\n    const indicesType = hasBoundElementArrayBuffer.indicesType;\r\n    gl.drawElements(primitiveType, count, indicesType, 0);\r\n  } else {\r\n    gl.drawArrays(primitiveType, 0, count);\r\n  }\r\n}\r\n\r\nexport default draw;\r\n","import createContext from './createContext.js';\r\nimport setState from './setState.js';\r\nimport getState from './getState.js';\r\nimport createFramebuffer from './createFramebuffer.js';\r\nimport createTexture from './createTexture.js';\r\nimport updateTexture from './updateTexture.js';\r\nimport createCubeMap from './createCubeMap.js';\r\nimport createVAO from './createVAO.js';\r\nimport clear from './clear.js';\r\nimport draw from './draw.js';\r\n\r\nconst ToyGL = {\r\n  createContext,\r\n  setState,\r\n  getState,\r\n  clear,\r\n  draw,\r\n  createTexture,\r\n  updateTexture,\r\n  createCubeMap,\r\n  createVAO,\r\n  createFramebuffer,\r\n};\r\n\r\nexport default ToyGL;\r\n","import WebGLConstant from './WebglConstant.js';\r\n\r\nexport default function getState(gl) {\r\n  // cull face-related state\r\n  const cullFaceEnabled = gl.getParameter(gl.CULL_FACE);\r\n  const cullFaceMode = gl.getParameter(gl.CULL_FACE_MODE);\r\n  \r\n  // stencil-related state\r\n  const depthTestEnabled = gl.getParameter(gl.DEPTH_TEST);\r\n  const depthClearValue = gl.getParameter(gl.DEPTH_CLEAR_VALUE);\r\n  const depthFunc = gl.getParameter(gl.DEPTH_FUNC);\r\n  const depthWritemask = gl.getParameter(gl.DEPTH_WRITEMASK);\r\n  const depthRange = gl.getParameter(gl.DEPTH_RANGE);\r\n  const depthBits = gl.getParameter(gl.DEPTH_BITS);\r\n\r\n  const stencilTestEnabled = gl.getParameter(gl.STENCIL_TEST);\r\n  const stencilClearValue = gl.getParameter(gl.STENCIL_CLEAR_VALUE);\r\n\r\n  const stencilRef = gl.getParameter(gl.STENCIL_REF);\r\n  const stencilFunc = gl.getParameter(gl.STENCIL_FUNC);\r\n  const stencilFail = gl.getParameter(gl.STENCIL_FAIL);\r\n  const stencilPassDepthFail = gl.getParameter(gl.STENCIL_PASS_DEPTH_FAIL);\r\n  const stencilPassDepthPass = gl.getParameter(gl.STENCIL_PASS_DEPTH_PASS);\r\n  const stencilValueMask = gl.getParameter(gl.STENCIL_VALUE_MASK);\r\n  const stencilWritemask = gl.getParameter(gl.STENCIL_WRITEMASK);\r\n\r\n  const stencilBackRef = gl.getParameter(gl.STENCIL_BACK_REF);\r\n  const stencilBackFunc = gl.getParameter(gl.STENCIL_BACK_FUNC);\r\n  // what action is taken for back-facing polygons when the stencil test fails. Initial value is KEEP\r\n  const stencilBackFail = gl.getParameter(gl.STENCIL_BACK_FAIL);\r\n  const stencilBackPassDepthFail = gl.getParameter(gl.STENCIL_BACK_PASS_DEPTH_FAIL);\r\n  const stencilBackPassDepthPass = gl.getParameter(gl.STENCIL_BACK_PASS_DEPTH_PASS);\r\n  const stencilBackValueMask = gl.getParameter(gl.STENCIL_BACK_VALUE_MASK);\r\n  const stencilBackWritemask = gl.getParameter(gl.STENCIL_BACK_WRITEMASK);\r\n\r\n  const stencilBits = gl.getParameter(gl.STENCIL_BITS);\r\n\r\n  // blend\r\n  const blendEnable = gl.getParameter(gl.BLEND);\r\n  // blendColor\r\n  const blendColor = gl.getParameter(gl.BLEND_COLOR);\r\n  // blendFuncSeparate\r\n  const blendDstRGB = gl.getParameter(gl.BLEND_DST_RGB);\r\n  const blendDstAlpha = gl.getParameter(gl.BLEND_DST_ALPHA);\r\n  const blendSrcRGB = gl.getParameter(gl.BLEND_SRC_RGB);\r\n  const blendSrcAlpha = gl.getParameter(gl.BLEND_SRC_ALPHA);\r\n  // blendEquationSeparate\r\n  const blendEquationRGB = gl.getParameter(gl.BLEND_EQUATION_RGB);\r\n  const blendEquationAlpha = gl.getParameter(gl.BLEND_EQUATION_ALPHA);\r\n\r\n  // viewport\r\n  const currentViewport = gl.getParameter(gl.VIEWPORT);\r\n  const maxViewportDims = gl.getParameter(gl.MAX_VIEWPORT_DIMS);\r\n\r\n  const scissorTestEnable = gl.getParameter(gl.SCISSOR_TEST);\r\n  const scissorBox = gl.getParameter(gl.SCISSOR_BOX);\r\n\r\n  // polygon offset fill\r\n  const polygonOffsetFillEnable = gl.getParameter(gl.POLYGON_OFFSET_FILL);\r\n  const polygonOffsetFactor = gl.getParameter(gl.POLYGON_OFFSET_FACTOR);\r\n  const polygonOffsetUnits = gl.getParameter(gl.POLYGON_OFFSET_UNITS);\r\n\r\n  const ditherEnable = gl.getParameter(gl.DITHER);\r\n\r\n  // \r\n  const redBits = gl.getParameter(gl.RED_BITS);\r\n  const greenBits = gl.getParameter(gl.GREEN_BITS);\r\n  const blueBits = gl.getParameter(gl.BLUE_BITS);\r\n  const alphaBits = gl.getParameter(gl.ALPHA_BITS);\r\n  const subpixelBits = gl.getParameter(gl.SUBPIXEL_BITS);\r\n\r\n  const aliasedLineWidthRange = gl.getParameter(gl.ALIASED_LINE_WIDTH_RANGE);\r\n  const aliasedPointSizeRange = gl.getParameter(gl.ALIASED_POINT_SIZE_RANGE);\r\n\r\n  // color write mask\r\n  const colorWritemask = gl.getParameter(gl.COLOR_WRITEMASK);\r\n  const colorClearValue = gl.getParameter(gl.COLOR_CLEAR_VALUE);\r\n\r\n  // texture-related state\r\n  const activeTexture = gl.getParameter(gl.ACTIVE_TEXTURE);\r\n  // The maximum number of texture image units available to the fragment stage of the GL\r\n  const maxTextureImageUnits = gl.getParameter(gl.MAX_TEXTURE_IMAGE_UNITS);\r\n  // Both the vertex shader and fragment processing combined cannot use more than MAX_COMBINED_TEXTURE_IMAGE_UNITS texture image units.\r\n  const maxCombinedTextureImageUnits = gl.getParameter(gl.MAX_COMBINED_TEXTURE_IMAGE_UNITS);\r\n  const maxTextureSize = gl.getParameter(gl.MAX_TEXTURE_SIZE);\r\n  const maxCubeMapTextureSize = gl.getParameter(gl.MAX_CUBE_MAP_TEXTURE_SIZE);\r\n  const maxRenderbuffereSize = gl.getParameter(gl.MAX_RENDERBUFFER_SIZE);\r\n\r\n  // \r\n  const maxVertexAttribs = gl.getParameter(gl.MAX_VERTEX_ATTRIBS);\r\n  // The maximum number of texture image units available to a vertex shader\r\n  const maxVertexTextureImageUnits = gl.getParameter(gl.MAX_VERTEX_TEXTURE_IMAGE_UNITS);\r\n  const maxVertexUniformVectors = gl.getParameter(gl.MAX_VERTEX_UNIFORM_VECTORS);\r\n  const maxVaryingVectors = gl.getParameter(gl.MAX_VARYING_VECTORS);\r\n\r\n  // gl.pixelStorei(pname, param)\r\n  const packAlignment = gl.getParameter(gl.PACK_ALIGNMENT);\r\n  const unpackAlignment = gl.getParameter(gl.UNPACK_ALIGNMENT);\r\n  const unpackColorspaceConversionWebgl = gl.getParameter(gl.UNPACK_COLORSPACE_CONVERSION_WEBGL)\r\n  const unpackFlipYWebgl = gl.getParameter(gl.UNPACK_FLIP_Y_WEBGL);\r\n  const unpackPremultiplyAlphaWebgl = gl.getParameter(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL);\r\n\r\n  // \r\n  const vendor = gl.getParameter(gl.VENDOR); \r\n  const version = gl.getParameter(gl.VERSION); \r\n\r\n  // Uint32Array\r\n  const compressedTextureFormats = gl.getParameter(gl.COMPRESSED_TEXTURE_FORMATS);\r\n\r\n  // binding\r\n  const currentProgram = gl.getParameter(gl.CURRENT_PROGRAM);\r\n  const arrayBufferBinding = gl.getParameter(gl.ARRAY_BUFFER_BINDING);\r\n  const elementArrayBufferBinding = gl.getParameter(gl.ELEMENT_ARRAY_BUFFER_BINDING);\r\n  const framebufferBinding = gl.getParameter(gl.FRAMEBUFFER_BINDING);\r\n  const renderbufferBinding = gl.getParameter(gl.RENDERBUFFER_BINDING);\r\n  const textureBinding2D = gl.getParameter(gl.TEXTURE_BINDING_2D);\r\n  const textureBindingCubeMap = gl.getParameter(gl.TEXTURE_BINDING_CUBE_MAP);\r\n  const renderer = gl.getParameter(gl.RENDERER);\r\n\r\n  // sample coverage\r\n  const samples = gl.getParameter(gl.SAMPLES);\r\n  const sampleBuffers = gl.getParameter(gl.SAMPLE_BUFFERS);\r\n  const sampleAlphaToCoverage = gl.getParameter(gl.SAMPLE_ALPHA_TO_COVERAGE);\r\n  const sampleCoverageInvert = gl.getParameter(gl.SAMPLE_COVERAGE_INVERT);\r\n  const sampleConverageValue =  gl.getParameter(gl.SAMPLE_COVERAGE_VALUE);\r\n\r\n  const frontFaceOrder = gl.getParameter(gl.FRONT_FACE);\r\n\r\n  const lineWidth = gl.getParameter(gl.LINE_WIDTH);\r\n\r\n  const generateMipmapHint = gl.getParameter(gl.GENERATE_MIPMAP_HINT);\r\n\r\n  const shadingLanguageVersion = gl.getParameter(gl.SHADING_LANGUAGE_VERSION);\r\n\r\n\r\n  return {\r\n    cullFace: {\r\n      CULL_FACE: cullFaceEnabled,\r\n      CULL_FACE_MODE: WebGLConstant[cullFaceMode],\r\n    },\r\n    depth: {\r\n      DEPTH_TEST: depthTestEnabled,\r\n      DEPTH_CLEAR_VALUE: depthClearValue,\r\n      DEPTH_FUNC: WebGLConstant[depthFunc],\r\n      DEPTH_WRITEMASK: depthWritemask,\r\n      DEPTH_RANGE: depthRange,\r\n      DEPTH_BITS: depthBits,\r\n    },\r\n    stencil: {\r\n      STENCIL_TEST: stencilTestEnabled,\r\n      STENCIL_CLEAR_VALUE: stencilClearValue,\r\n      STENCIL_BITS: stencilBits,\r\n      front: {\r\n        STENCIL_REF: stencilRef,\r\n        STENCIL_FUNC: WebGLConstant[stencilFunc],\r\n        STENCIL_FAIL: WebGLConstant[stencilFail],\r\n        STENCIL_PASS_DEPTH_FAIL: WebGLConstant[stencilPassDepthFail],\r\n        STENCIL_PASS_DEPTH_PASS: WebGLConstant[stencilPassDepthPass],\r\n        STENCIL_VALUE_MASK: Number(stencilValueMask).toString(16),\r\n        STENCIL_WRITEMASK: Number(stencilWritemask).toString(16),\r\n      },\r\n      back: {\r\n        STENCIL_BACK_REF: stencilBackRef,\r\n        STENCIL_BACK_FUNC: WebGLConstant[stencilBackFunc],\r\n        STENCIL_BACK_FAIL: WebGLConstant[stencilBackFail],\r\n        STENCIL_BACK_PASS_DEPTH_FAIL: WebGLConstant[stencilBackPassDepthFail],\r\n        STENCIL_BACK_PASS_DEPTH_PASS: WebGLConstant[stencilBackPassDepthPass],\r\n        STENCIL_BACK_VALUE_MASK: Number(stencilBackValueMask).toString(16),\r\n        STENCIL_BACK_WRITEMASK: Number(stencilBackWritemask).toString(16),  \r\n      },\r\n    },\r\n    blend: {\r\n      BLEND: blendEnable,\r\n      BLEND_COLOR: blendColor,\r\n      BLEND_DST_RGB: WebGLConstant[blendDstRGB],\r\n      BLEND_DST_ALPHA: WebGLConstant[blendDstAlpha],\r\n      BLEND_SRC_RGB: WebGLConstant[blendSrcRGB],\r\n      BLEND_SRC_ALPHA: WebGLConstant[blendSrcAlpha],\r\n      BLEND_EQUATION_RGB: WebGLConstant[blendEquationRGB],\r\n      BLEND_EQUATION_ALPHA: WebGLConstant[blendEquationAlpha],\r\n    },\r\n    viewport: {\r\n      VIEWPORT: currentViewport,\r\n      MAX_VIEWPORT_DIMS: maxViewportDims,\r\n    },\r\n    scissor: {\r\n      SCISSOR_TEST: scissorTestEnable,\r\n      SCISSOR_BOX: scissorBox,\r\n    },\r\n    polygonOffset: {\r\n      POLYGON_OFFSET_FILL: polygonOffsetFillEnable,\r\n      POLYGON_OFFSET_FACTOR: polygonOffsetFactor,\r\n      POLYGON_OFFSET_UNITS: polygonOffsetUnits,\r\n    },\r\n    DITHER: ditherEnable,\r\n\r\n    binding: {\r\n      ARRAY_BUFFER_BINDING: arrayBufferBinding,\r\n      ELEMENT_ARRAY_BUFFER_BINDING: elementArrayBufferBinding,\r\n      CURRENT_PROGRAM: currentProgram,\r\n      FRAMEBUFFER_BINDING: framebufferBinding,\r\n      RENDERBUFFER_BINDING: renderbufferBinding,\r\n      TEXTURE_BINDING_2D: textureBinding2D,\r\n      TEXTURE_BINDING_CUBE: textureBindingCubeMap,\r\n    },\r\n    RENDERER: renderer,\r\n\r\n    color: {\r\n      RED_BITS: redBits,\r\n      GREEN_BITS: greenBits,\r\n      BLUE_BITS: blueBits,\r\n      ALPHA_BITS: alphaBits,\r\n      SUBPIXEL_BITS: subpixelBits,\r\n      COLOR_CLEAR_VALUE: colorClearValue,\r\n      COLOR_WRITEMASK: colorWritemask,\r\n    },\r\n    aliasedRange: {\r\n      ALIASED_LINE_WIDTH_RANGE : aliasedLineWidthRange,\r\n      ALIASED_POINT_SIZE_RANGE: aliasedPointSizeRange,\r\n    },\r\n    texture: {\r\n      MAX_TEXTURE_IMAGE_UNITS: maxTextureImageUnits,\r\n      MAX_COMBINED_TEXTURE_IMAGE_UNITS: maxCombinedTextureImageUnits,\r\n      ACTIVE_TEXTURE: WebGLConstant[activeTexture],\r\n      MAX_TEXTURE_SIZE: maxTextureSize,\r\n      MAX_CUBE_MAP_TEXTURE_SIZE: maxCubeMapTextureSize,\r\n      MAX_RENDERBUFFER_SIZE: maxRenderbuffereSize,\r\n    },\r\n    COMPRESSED_TEXTURE_FORMATS: Array.from(compressedTextureFormats).map(format => WebGLConstant[format]),\r\n    // numCompressedTextureFormats,\r\n\r\n    GENERATE_MIPMAP_HINT: WebGLConstant[generateMipmapHint],\r\n    LINE_WIDTH: lineWidth,\r\n    FRONT_FACE: WebGLConstant[frontFaceOrder],\r\n\r\n    SHADING_LANGUAGE_VERSION: shadingLanguageVersion,\r\n    vertex: {\r\n      MAX_VERTEX_ATTRIBS: maxVertexAttribs,\r\n      MAX_VERTEX_TEXTURE_IMAGE_UNITS: maxVertexTextureImageUnits,\r\n      MAX_VERTEX_UNIFORM_VECTORS: maxVertexUniformVectors,\r\n      MAX_VARYING_VECTORS: maxVaryingVectors\r\n    },\r\n    sample: {\r\n      SAMPLES: samples,\r\n      SAMPLE_BUFFERS: sampleBuffers,\r\n      SAMPLE_ALPHA_TO_COVERAGE: sampleAlphaToCoverage,\r\n      SAMPLE_COVERAGE_VALUE: sampleConverageValue,\r\n      SAMPLE_COVERAGE_INVERT: sampleCoverageInvert\r\n    },\r\n    unpack: {\r\n      PACK_ALIGNMENT: packAlignment,\r\n      UNPACK_ALIGNMENT: unpackAlignment,\r\n      UNPACK_FLIP_Y_WEBGL: unpackFlipYWebgl,\r\n      UNPACK_PREMULTIPLY_ALPHA_WEBGL: unpackPremultiplyAlphaWebgl,\r\n      UNPACK_COLORSPACE_CONVERSION_WEBGL: WebGLConstant[unpackColorspaceConversionWebgl],\r\n    },\r\n    VENDOR: vendor,\r\n    VERSION: version,\r\n  };\r\n}\r\n","import defined from './defined.js';\r\nimport defaultValue from './defaultValue.js';\r\n\r\n/**\r\n * Execute a clear command.\r\n * @param {WebGLRenderingContext} gl \r\n * @param {Object} [options] \r\n * @param {Array} [options.color] \r\n * @param {Number} [options.depth] \r\n * @param {Number} [options.stencil] \r\n * @param {WebGLFramebuffer} [options.fb] \r\n */\r\nfunction clear(gl, options) {\r\n  options = defaultValue(options, defaultValue.EMPTY_OBJECT);\r\n  const { fb, color, depth, stencil } = options;\r\n\r\n  gl.bindFramebuffer(gl.FRAMEBUFFER, fb);\r\n\r\n  let mask = 0;\r\n  if (color) {\r\n    gl.clearColor(color[0], color[1], color[2], color[3]);\r\n    mask |= gl.COLOR_BUFFER_BIT;\r\n  }\r\n  if (defined(depth)) {\r\n    gl.clearDepth(depth);\r\n    mask |= gl.DEPTH_BUFFER_BIT;\r\n  }\r\n  if (stencil) {\r\n    gl.clearStencil(stencil);\r\n    mask |= gl.STENCIL_BUFFER_BIT;\r\n  }\r\n\r\n  if (mask !== 0) {\r\n    gl.clear(mask);\r\n  }\r\n}\r\n\r\nexport default clear;\r\n","// see https://stackoverflow.com/questions/24048547/checking-if-an-object-is-array-like\r\nfunction isArrayLike(item) {\r\n  return (\r\n    Array.isArray(item) || \r\n    (!!item &&\r\n      typeof item === \"object\" &&\r\n      typeof (item.length) === \"number\" && \r\n      (item.length === 0 ||\r\n        (item.length > 0 && \r\n        (item.length - 1) in item)\r\n      )\r\n    )\r\n  );\r\n}\r\n\r\nexport default isArrayLike;\r\n","import isPowerOfTwo from './isPowerOfTwo.js';\r\nimport defined from './defined.js';\r\nimport defaultValue from './defaultValue.js';\r\n\r\n/**\r\n * Create a WebGLTexture.\r\n * @memberof ToyGL\r\n * @param {WebGLRenderingContext} gl \r\n * @param {Object} options \r\n * @param {Array.<ArrayBufferView | HTMLImageElement | HTMLCanvasElement | HTMLVideoElement>} options.levels all levels data\r\n * @param {ArrayBufferView | HTMLImageElement | HTMLCanvasElement | HTMLVideoElement} options.data level 0 data\r\n * @param {Number} options.width\r\n * @param {Number} options.height\r\n * @param {Number} [options.depth=1]\r\n * @param {Number} options.internalFormat For WebGL1, internal format must same with format.\r\n * @param {Number} options.format\r\n * @param {Number} options.type Texel data type, such as <code>gl.UNSIGNED_BYTE</code>, <code>gl.FLOAT</code>, <code>gl.UNSIGNED_INT</code>.\r\n * @param {Number} [options.target=TEXTURE_2D]\r\n * @param {Boolean} [options.generateMipmap=false]\r\n * @param {Number} [options.wrapS=CLAMP_TO_EDGE]\r\n * @param {Number} [options.wrapT=CLAMP_TO_EDGE]\r\n * @param {Number} [options.wrapR=CLAMP_TO_EDGE]\r\n * @param {Number} [options.minFilter=LINEAR]\r\n * @param {Number} [options.magFilter=LINEAR]\r\n * @param {Number} [options.flipY=false] Only valid for DOM-Element uploads\r\n * @param {Number} [options.premultiplyAlpha=false] Only valid for DOM-Element uploads\r\n * @returns {WebGLTexture}\r\n */\r\nfunction createTexture(gl, options) {\r\n  const { internalFormat, type, format, width, height, data, generateMipmap } = options;\r\n\r\n  const depth = defaultValue(options.depth, 1);\r\n  const wrapS = defaultValue(options.wrapS, gl.CLAMP_TO_EDGE);\r\n  const wrapT = defaultValue(options.wrapT, gl.CLAMP_TO_EDGE);\r\n  const wrapR = defaultValue(options.wrapR, gl.CLAMP_TO_EDGE);\r\n  const minFilter = defaultValue(options.minFilter, gl.LINEAR);\r\n  const magFilter = defaultValue(options.magFilter, gl.LINEAR);\r\n\r\n  let levels = options.levels;\r\n  if (!levels) {\r\n    levels = [ data ];\r\n  }\r\n\r\n  const flipY = defaultValue(options.flipY, false);\r\n  const premultiplyAlpha = defaultValue(options.premultiplyAlpha, false);\r\n  gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, flipY);\r\n  gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, premultiplyAlpha);\r\n\r\n  const texture = gl.createTexture();\r\n  const textureTarget = defaultValue(options.target, gl.TEXTURE_2D);\r\n\r\n  gl.activeTexture(gl.TEXTURE0);\r\n  gl.bindTexture(textureTarget, texture);\r\n\r\n\r\n  if (type === gl.FLOAT) {\r\n    if (gl instanceof WebGLRenderingContext && !gl._textureFloat) {\r\n      console.warn('Do not support float texture.');\r\n    }\r\n\r\n    if ((minFilter === gl.LINEAR ||\r\n      minFilter === gl.LINEAR_MIPMAP_NEAREST ||\r\n      minFilter === gl.NEAREST_MIPMAP_LINEAR ||\r\n      minFilter === gl.LINEAR_MIPMAP_LINEAR) && !gl._textureFloatLinear\r\n    ) {\r\n      console.warn('Do not support float texture linear filter.');\r\n    }\r\n  }\r\n\r\n  const numberOfLevels = levels.length;\r\n  for (let level = 0; level < numberOfLevels; level++) {\r\n    const levelData = levels[level];\r\n\r\n    if (\r\n      levelData instanceof HTMLImageElement ||\r\n      levelData instanceof HTMLCanvasElement ||\r\n      levelData instanceof HTMLVideoElement\r\n    ) {\r\n      if (textureTarget === gl.TEXTURE_2D) {\r\n        gl.texImage2D(gl.TEXTURE_2D, level, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, levelData);\r\n      } else if (textureTarget === gl.TEXTURE_3D) {\r\n        // TODO:\r\n      }\r\n\r\n    } else {\r\n      const border = 0;\r\n      if (textureTarget === gl.TEXTURE_2D) {\r\n        gl.texImage2D(gl.TEXTURE_2D, level, internalFormat, width, height, border, format, type, levelData);\r\n      } else if (textureTarget === gl.TEXTURE_3D) {\r\n        gl.texImage3D(gl.TEXTURE_3D, level, internalFormat, width, height, depth, border, format, type, levelData);\r\n        gl.texParameteri(textureTarget, gl.TEXTURE_WRAP_R, wrapR);\r\n      }\r\n    }\r\n  }\r\n\r\n  gl.texParameteri(textureTarget, gl.TEXTURE_WRAP_S, wrapS);\r\n  gl.texParameteri(textureTarget, gl.TEXTURE_WRAP_T, wrapT);\r\n  gl.texParameteri(textureTarget, gl.TEXTURE_MIN_FILTER, minFilter);\r\n  gl.texParameteri(textureTarget, gl.TEXTURE_MAG_FILTER, magFilter);\r\n\r\n  if (generateMipmap === true) {\r\n    if ((isPowerOfTwo(width) && isPowerOfTwo(height)) || gl instanceof WebGL2RenderingContext) {\r\n      gl.generateMipmap(textureTarget);\r\n    } else {\r\n      console.warn('createTexture: texture size is NOT power of two, current is ' + width + 'x' + height + '.');\r\n    }\r\n  }\r\n\r\n  gl.bindTexture(textureTarget, null);\r\n\r\n  return texture;\r\n}\r\n\r\nexport default createTexture;\r\n","import defaultValue from \"./defaultValue\";\r\n\r\n/**\r\n * Update texture data.\r\n * @param {WebGLRenderingContext} gl \r\n * @param {WebGLTexture} texture \r\n * @param {Object | HTMLImageElement | HTMLCanvasElement | HTMLVideoElement} source \r\n * @param {Number} source.width \r\n * @param {Number} source.height \r\n * @param {TypedArray} source.arrayBufferView \r\n * @param {Number} [source.level=0] \r\n * @param {Number} [source.internalFormat=gl.RGBA] \r\n * @param {Number} [source.format=gl.RGBA] \r\n * @param {Number} [source.type=gl.UNSIGNED_BYTE] \r\n * @returns {WebGLTexture}\r\n */\r\nfunction updateTexture(gl, texture, source) {\r\n  gl.activeTexture(gl.TEXTURE0);\r\n  gl.bindTexture(gl.TEXTURE_2D, texture);\r\n\r\n  if (source instanceof HTMLImageElement ||\r\n    source instanceof HTMLCanvasElement ||\r\n    source instanceof HTMLVideoElement) {\r\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, videoElem);\r\n  } else {\r\n\r\n    const { width, height, arrayBufferView } = source;\r\n    const level = defaultValue(source.level, 0);\r\n    const internalFormat = defaultValue(source.internalFormat, gl.RGBA);\r\n    const format = defaultValue(source.format, gl.RGBA);\r\n    const type = defaultValue(source.internalFormat, gl.UNSIGNED_BYTE);\r\n    const border = 0;\r\n\r\n    gl.texImage2D(gl.TEXTURE_2D, level, internalFormat, width, height, border, format, type, arrayBufferView);\r\n  }\r\n\r\n  gl.bindTexture(gl.TEXTURE_2D, null);\r\n  return texture;\r\n}\r\n\r\nexport default updateTexture;\r\n","import defaultValue from './defaultValue.js';\r\n\r\nfunction createCubeMap(gl, options) {\r\n  options = defaultValue(options, defaultValue.EMPTY_OBJECT);\r\n  const level = defaultValue(options.level, 0);\r\n  const data = options.data;\r\n  const width = options.width;\r\n  const height = options.height;\r\n  const format = defaultValue(options.format, gl.RGBA);\r\n  const type = defaultValue(options.type, gl.UNSIGNED_BYTE);\r\n  const internalFormat = defaultValue(options.internalFormat, gl.RGBA);\r\n\r\n  const texture = gl.createTexture();\r\n  gl.activeTexture(gl.TEXTURE0);\r\n  gl.bindTexture(gl.TEXTURE_CUBE_MAP, texture);\r\n\r\n  const faces = [\r\n    {\r\n      target: gl.TEXTURE_CUBE_MAP_POSITIVE_X,\r\n      data: data.px,\r\n    },\r\n    {\r\n      target: gl.TEXTURE_CUBE_MAP_NEGATIVE_X,\r\n      data: data.nx,\r\n    },\r\n    {\r\n      target: gl.TEXTURE_CUBE_MAP_POSITIVE_Y,\r\n      data: data.py,\r\n    },\r\n    {\r\n      target: gl.TEXTURE_CUBE_MAP_NEGATIVE_Y,\r\n      data: data.ny,\r\n    },\r\n    {\r\n      target: gl.TEXTURE_CUBE_MAP_POSITIVE_Z,\r\n      data: data.pz,\r\n    },\r\n    {\r\n      target: gl.TEXTURE_CUBE_MAP_NEGATIVE_Z,\r\n      data: data.nz,\r\n    },\r\n  ]\r\n  \r\n  for (let i = 0; i < 6; i++) {\r\n    const face = faces[i];\r\n    const target = face.target;\r\n    const bufferView = face.data;\r\n    if (bufferView instanceof HTMLImageElement) {\r\n      gl.texImage2D(target, level, internalFormat, format, type, bufferView);\r\n    } else {\r\n      gl.texImage2D(target, level, internalFormat, width, height, 0, format, type, bufferView);\r\n    }\r\n\r\n    // default texture settings\r\n    gl.texParameteri(gl.TEXTURE_CUBE_MAP, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n    gl.texParameteri(gl.TEXTURE_CUBE_MAP, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n    gl.texParameteri(gl.TEXTURE_CUBE_MAP, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\r\n    gl.texParameteri(gl.TEXTURE_CUBE_MAP, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\r\n  }\r\n\r\n  gl.bindTexture(gl.TEXTURE_CUBE_MAP, null);\r\n\r\n  return texture;\r\n}\r\n\r\nexport default createCubeMap;\r\n"],"names":["defaultValue","a","b","EMPTY_OBJECT","Object","freeze","global","window","defined","validateStencilOp","op","toUpperCase","validateGLConstantDefination","gl","constantName","constant","Error","applyStencilStateSeparate","face","state","writeMask","stencilMaskSeparate","func","ref","valueMask","validateStencilFunc","stencilFuncSeparate","fail","zfail","zpass","stencilOpSeparate","WebGLConstant","34016","33984","33985","33986","33987","33988","33989","33990","33991","33992","33993","33994","33995","33996","33997","33998","33999","34000","34001","34002","34003","34004","34005","34006","34007","34008","34009","34010","34011","34012","34013","34014","34015","3410","3411","3412","3413","2884","2885","1028","1029","1032","512","513","514","515","516","517","518","519","0","1","5386","7680","7681","7682","7683","34055","34056","32774","32778","32779","768","770","774","772","32769","32771","769","771","775","773","32770","32772","2304","2305","4352","4353","4354","33776","33777","33778","33779","36492","36493","36494","36495","36283","36284","36285","36286","37444","BYTE","UNSIGNED_BYTE","SHORT","UNSIGNED_SHORT","INT","UNSIGNED_INT","FLOAT","FRAMEBUFFER_STATUS","36053","36054","36055","36057","36061","isPowerOfTwo","value","cachedBuffer","getIndicesType","indices","indicesType","max","i","length","Math","WebglConstant","createBuffer","bufferTarget","source","usage","buffer","bindBuffer","bufferData","createAttributeBuffer","typedArrayOrArray","bufferKey","element","toFixed","typedArray","STATIC_DRAW","Array","isArray","Float32Array","Uint8Array","Uint16Array","Uint32Array","Int8Array","Int16Array","Int32Array","ARRAY_BUFFER","createIndicesBuffer","toString","getExtension","ELEMENT_ARRAY_BUFFER","createVAO","options","createVertexArray","oldVao","getParameter","VERTEX_ARRAY_BINDING","vao","bindVertexArray","attributes","attributeName","hasOwnProperty","call","location","data","size","enableVertexAttribArray","type","normalized","stride","offset","vertexAttribPointer","indicesBuffer","cachedProgram","cachedTextures","getNumberOfComponentsByType","numberOfComponents","getAttributeSize","activeAttribute","name","vaoCache","createContext","contextOptions","canvas","document","createElement","style","width","height","setProperty","innerWidth","innerHeight","requireWebgl2","getContext","extVAO","createVertexArrayOES","bind","bindVertexArrayOES","deleteVertexArray","deleteVertexArrayOES","isVertexArray","isVertexArrayOES","VERTEX_ARRAY_BINDING_OES","drawArraysInstanced","extInstancedArrays","drawArraysInstancedANGLE","drawElementsInstanced","drawElementsInstancedANGLE","vertexAttribDivisor","vertexAttribDivisorANGLE","VERTEX_ATTRIB_ARRAY_DIVISOR","VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE","drawBuffers","extDrawBuffers","drawBuffersWEBGL","MAX_COLOR_ATTACHMENTS","MAX_COLOR_ATTACHMENTS_WEBGL","MAX_DRAW_BUFFERS","MAX_DRAW_BUFFERS_WEBGL","MAX_TEXTURE_MAX_ANISOTROPY","extTextureFilterAnisotropic","MAX_TEXTURE_MAX_ANISOTROPY_EXT","TEXTURE_MAX_ANISOTROPY","TEXTURE_MAX_ANISOTROPY_EXT","MIN","extBlendMinmax","MIN_EXT","MAX","MAX_EXT","FRAGMENT_SHADER_DERIVATIVE_HINT","extStandardDerivatives","FRAGMENT_SHADER_DERIVATIVE_HINT_OES","UNSIGNED_INT_24_8","extDepthTexture","UNSIGNED_INT_24_8_WEBGL","HALF_FLOAT","extTextureHalfFloat","HALF_FLOAT_OES","extS3tc","extPvrtc","extAstc","extEtc","extEtc1","extBc7","extDebugShaders","_elementIndexUint","_fragDepth","_textureFloat","_textureFloatLinear","_colorBufferFloat","_colorBufferHalfFloat","_floatBlend","_shaderTextureLod","setState","depthTest","stencilTest","colorMask","cull","blend","viewport","scissor","polygonOffset","sampleCoverage","dither","enable","CULL_FACE","disable","cullFace","frontFace","DEPTH_TEST","depthFunc","write","depthMask","STENCIL_TEST","front","back","FRONT","BACK","BLEND","blendColor","blendEquationSeparate","rgb","alpha","RGB","ALPHA","glRGB","glALPHA","blendEquation","equationName","equation","blendFuncSeparate","srcRGB","dstRGB","srcAlpha","dstAlpha","SRCRGB","DSTRGB","SRCALPHA","DSTALPHA","glSrcRGB","glDstRGB","glSrcAlpha","glDstAlpha","blendFunc","srcFuncName","dstFuncName","src","dst","SCISSOR_TEST","rect","POLYGON_OFFSET_FILL","console","warn","factor","units","alphaToCoverage","invert","SAMPLE_ALPHA_TO_COVERAGE","SAMPLE_COVERAGE","DITHER","getState","cullFaceEnabled","cullFaceMode","CULL_FACE_MODE","depthTestEnabled","depthClearValue","DEPTH_CLEAR_VALUE","DEPTH_FUNC","depthWritemask","DEPTH_WRITEMASK","depthRange","DEPTH_RANGE","depthBits","DEPTH_BITS","stencilTestEnabled","stencilClearValue","STENCIL_CLEAR_VALUE","stencilRef","STENCIL_REF","stencilFunc","STENCIL_FUNC","stencilFail","STENCIL_FAIL","stencilPassDepthFail","STENCIL_PASS_DEPTH_FAIL","stencilPassDepthPass","STENCIL_PASS_DEPTH_PASS","stencilValueMask","STENCIL_VALUE_MASK","stencilWritemask","STENCIL_WRITEMASK","stencilBackRef","STENCIL_BACK_REF","stencilBackFunc","STENCIL_BACK_FUNC","stencilBackFail","STENCIL_BACK_FAIL","stencilBackPassDepthFail","STENCIL_BACK_PASS_DEPTH_FAIL","stencilBackPassDepthPass","STENCIL_BACK_PASS_DEPTH_PASS","stencilBackValueMask","STENCIL_BACK_VALUE_MASK","stencilBackWritemask","STENCIL_BACK_WRITEMASK","stencilBits","STENCIL_BITS","blendEnable","BLEND_COLOR","blendDstRGB","BLEND_DST_RGB","blendDstAlpha","BLEND_DST_ALPHA","blendSrcRGB","BLEND_SRC_RGB","blendSrcAlpha","BLEND_SRC_ALPHA","blendEquationRGB","BLEND_EQUATION_RGB","blendEquationAlpha","BLEND_EQUATION_ALPHA","currentViewport","VIEWPORT","maxViewportDims","MAX_VIEWPORT_DIMS","scissorTestEnable","scissorBox","SCISSOR_BOX","polygonOffsetFillEnable","polygonOffsetFactor","POLYGON_OFFSET_FACTOR","polygonOffsetUnits","POLYGON_OFFSET_UNITS","ditherEnable","redBits","RED_BITS","greenBits","GREEN_BITS","blueBits","BLUE_BITS","alphaBits","ALPHA_BITS","subpixelBits","SUBPIXEL_BITS","aliasedLineWidthRange","ALIASED_LINE_WIDTH_RANGE","aliasedPointSizeRange","ALIASED_POINT_SIZE_RANGE","colorWritemask","COLOR_WRITEMASK","colorClearValue","COLOR_CLEAR_VALUE","activeTexture","ACTIVE_TEXTURE","maxTextureImageUnits","MAX_TEXTURE_IMAGE_UNITS","maxCombinedTextureImageUnits","MAX_COMBINED_TEXTURE_IMAGE_UNITS","maxTextureSize","MAX_TEXTURE_SIZE","maxCubeMapTextureSize","MAX_CUBE_MAP_TEXTURE_SIZE","maxRenderbuffereSize","MAX_RENDERBUFFER_SIZE","maxVertexAttribs","MAX_VERTEX_ATTRIBS","maxVertexTextureImageUnits","MAX_VERTEX_TEXTURE_IMAGE_UNITS","maxVertexUniformVectors","MAX_VERTEX_UNIFORM_VECTORS","maxVaryingVectors","MAX_VARYING_VECTORS","packAlignment","PACK_ALIGNMENT","unpackAlignment","UNPACK_ALIGNMENT","unpackColorspaceConversionWebgl","UNPACK_COLORSPACE_CONVERSION_WEBGL","unpackFlipYWebgl","UNPACK_FLIP_Y_WEBGL","unpackPremultiplyAlphaWebgl","UNPACK_PREMULTIPLY_ALPHA_WEBGL","vendor","VENDOR","version","VERSION","compressedTextureFormats","COMPRESSED_TEXTURE_FORMATS","currentProgram","CURRENT_PROGRAM","arrayBufferBinding","ARRAY_BUFFER_BINDING","elementArrayBufferBinding","ELEMENT_ARRAY_BUFFER_BINDING","framebufferBinding","FRAMEBUFFER_BINDING","renderbufferBinding","RENDERBUFFER_BINDING","textureBinding2D","TEXTURE_BINDING_2D","textureBindingCubeMap","TEXTURE_BINDING_CUBE_MAP","renderer","RENDERER","samples","SAMPLES","sampleBuffers","SAMPLE_BUFFERS","sampleAlphaToCoverage","sampleCoverageInvert","SAMPLE_COVERAGE_INVERT","sampleConverageValue","SAMPLE_COVERAGE_VALUE","frontFaceOrder","FRONT_FACE","lineWidth","LINE_WIDTH","generateMipmapHint","GENERATE_MIPMAP_HINT","shadingLanguageVersion","SHADING_LANGUAGE_VERSION","depth","stencil","Number","binding","TEXTURE_BINDING_CUBE","color","aliasedRange","texture","from","map","format","vertex","sample","unpack","clear","fb","bindFramebuffer","FRAMEBUFFER","mask","clearColor","COLOR_BUFFER_BIT","clearDepth","DEPTH_BUFFER_BIT","clearStencil","STENCIL_BUFFER_BIT","draw","vs","vsSource","fs","fsSource","attributeLocations","count","primitiveType","TRIANGLES","uniforms","key","program","vertexShaderSource","fragmentShaderSource","createShader","VERTEX_SHADER","shaderSource","compileShader","FRAGMENT_SHADER","createProgram","attachShader","deleteShader","bindAttribLocation","linkProgram","log","getProgramParameter","LINK_STATUS","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","error","getProgramInfoLog","useProgram","numberOfAttributes","ACTIVE_ATTRIBUTES","vaoKey","getVaoKey","vaoAttributes","getActiveAttrib","attribute","attribLocation","getAttribLocation","numberOfUniforms","ACTIVE_UNIFORMS","maximumTextureUnits","currentTextureUnit","activeUniform","getActiveUniform","uniformName","isUniformArray","indexOfBracket","indexOf","slice","uniform","uniformLocation","getUniformLocation","typeOfUniform","textureUnit","TEXTURE0","WebGLTexture","SAMPLER_2D","bindTexture","TEXTURE_2D","SAMPLER_3D","TEXTURE_3D","SAMPLER_CUBE","TEXTURE_CUBE_MAP","uniform1i","item","order","floor","sqrt","transpose","uniform1f","BOOL","createTexture","texParameteri","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","TEXTURE_MIN_FILTER","LINEAR","TEXTURE_MAG_FILTER","texImage2D","RGBA","image","Image","addEventListener","hasBoundElementArrayBuffer","drawElements","drawArrays","internalFormat","generateMipmap","wrapS","wrapT","wrapR","minFilter","magFilter","levels","flipY","premultiplyAlpha","pixelStorei","textureTarget","target","WebGLRenderingContext","LINEAR_MIPMAP_NEAREST","NEAREST_MIPMAP_LINEAR","LINEAR_MIPMAP_LINEAR","numberOfLevels","level","levelData","HTMLImageElement","HTMLCanvasElement","HTMLVideoElement","border","texImage3D","TEXTURE_WRAP_R","WebGL2RenderingContext","updateTexture","videoElem","arrayBufferView","createCubeMap","faces","TEXTURE_CUBE_MAP_POSITIVE_X","px","TEXTURE_CUBE_MAP_NEGATIVE_X","nx","TEXTURE_CUBE_MAP_POSITIVE_Y","py","TEXTURE_CUBE_MAP_NEGATIVE_Y","ny","TEXTURE_CUBE_MAP_POSITIVE_Z","pz","TEXTURE_CUBE_MAP_NEGATIVE_Z","nz","bufferView","createFramebuffer","colorTexture","depthTexture","depthRenderbuffer","colorAttachments","colorAttachmentsLength","ext","push","COLOR_ATTACHMENT0_WEBGL","colorAttachment","framebufferTexture2D","COLOR_ATTACHMENT0","DEPTH_ATTACHMENT","renderbuffer","createRenderbuffer","bindRenderbuffer","RENDERBUFFER","renderbufferStorage","DEPTH_COMPONENT16","framebufferRenderbuffer","status","checkFramebufferStatus","FRAMEBUFFER_COMPLETE"],"mappings":";;;;sOAAA,SAASA,EAAaC,EAAGC,GACvB,OAAID,MAAAA,EACKC,EAEFD,EAGTD,EAAaG,aAAeC,OAAOC,OAAO,ICL1C,MAAMC,EAASC,OCFf,SAASC,EAAQP,GACf,OAAOA,MAAAA,ECwFT,SAASQ,EAAkBC,GAEzB,MAAW,UADXA,EAAKA,EAAGC,gBAEC,SAAPD,GACO,YAAPA,GACO,SAAPA,GACO,SAAPA,GACO,WAAPA,GACO,cAAPA,GACO,cAAPA,EAOJ,SAASE,EAA6BC,EAAIC,GACxC,MAAMC,EAAWF,EAAGC,GACpB,IAAKN,EAAQO,GACX,MAAM,IAAIC,MAAM,MAAQF,EAAe,oBAEzC,OAAOC,ECvGT,SAASE,EAA0BJ,EAAIK,EAAMC,GAK3C,GAJIX,EAAQW,EAAMC,YAChBP,EAAGQ,oBAAoBH,EAAMC,EAAMC,WAGjCZ,EAAQW,EAAMG,OAChBd,EAAQW,EAAMI,MACdf,EAAQW,EAAMK,WACd,CACA,IAAwC,IDyD5C,SAA6BF,GAE3B,MAAa,WADbA,EAAOA,EAAKX,gBAED,WAATW,GACS,SAATA,GACS,WAATA,GACS,aAATA,GACS,UAATA,GACS,YAATA,GACS,WAATA,EClEIG,CAAoBN,EAAMG,MAC5B,MAAM,IAAIN,MAAM,iDAAmDG,EAAMG,KAAO,KAElF,MAAMA,EAAOH,EAAMG,KAAKX,cACxBE,EAAGa,oBAAoBR,EAAML,EAAGS,GAAOH,EAAMI,IAAKJ,EAAMK,WAG1D,GAAIhB,EAAQW,EAAMQ,OAChBnB,EAAQW,EAAMS,QACdpB,EAAQW,EAAMU,OACd,CACA,IAAsC,IAAlCpB,EAAkBU,EAAMQ,QACS,IAAnClB,EAAkBU,EAAMS,SACW,IAAnCnB,EAAkBU,EAAMU,OAExB,MAAM,IAAIb,MAAM,+CAAiDG,EAAMQ,KAAO,KAAOR,EAAMS,MAAQ,KAAOT,EAAMU,MAAQ,KAE1H,MAAMF,EAAOR,EAAMQ,KAAKhB,cAClBiB,EAAQT,EAAMS,MAAMjB,cACpBkB,EAAQV,EAAMU,MAAMlB,cAC1BE,EAAGiB,kBAAkBZ,EAAML,EAAGc,GAAOd,EAAGe,GAAQf,EAAGgB,KCpCvD,MAAME,EAAgB,CAEpBC,MAAO,iBACPC,MAAO,WACPC,MAAO,WACPC,MAAO,WACPC,MAAO,WACPC,MAAO,WACPC,MAAO,WACPC,MAAO,WACPC,MAAO,WACPC,MAAO,WACPC,MAAO,WACPC,MAAO,YACPC,MAAO,YACPC,MAAO,YACPC,MAAO,YACPC,MAAO,YACPC,MAAO,YACPC,KAAO,YACPC,MAAO,YACPC,MAAO,YACPC,MAAO,YACPC,MAAO,YACPC,MAAO,YACPC,MAAO,YACPC,MAAO,YACPC,MAAO,YACPC,MAAO,YACPC,MAAO,YACPC,MAAO,YACPC,MAAO,YACPC,MAAO,YACPC,MAAO,YACPC,MAAO,YAEPC,KAAM,WACNC,KAAM,aACNC,KAAM,YACNC,KAAM,aAENC,KAAM,YAENC,KAAM,iBACNC,KAAM,QACNC,KAAM,OACNC,KAAM,iBAGNC,IAAK,QACLC,IAAK,OACLC,IAAK,QACLC,IAAK,SACLC,IAAK,UACLC,IAAK,WACLC,IAAK,SACLC,IAAK,SAILC,EAAG,OACHC,EAAG,MACHC,KAAM,SACNC,KAAM,OACNC,KAAM,UACNC,KAAM,OACNC,KAAM,OACNC,MAAO,YACPC,MAAO,YAGPC,MAAO,WACPC,MAAO,gBACPC,MAAO,wBAGPC,IAAK,YACLC,IAAK,YACLC,IAAK,YACLC,IAAK,YACLC,MAAO,iBACPC,MAAO,iBAEPC,IAAK,sBACLC,IAAK,sBACLC,IAAK,sBACLC,IAAK,sBACLC,MAAO,2BACPC,MAAO,2BAGPC,KAAM,KACNC,KAAM,MAGNC,KAAM,YACNC,KAAM,UACNC,KAAM,SAGNC,MAAO,+BACPC,MAAO,gCACPC,MAAO,gCACPC,MAAO,gCAEPC,MAAO,iCACPC,MAAO,uCACPC,MAAO,uCACPC,MAAO,yCAEPC,MAAO,2BACPC,MAAO,kCACPC,MAAO,iCACPC,MAAO,wCAGPC,MAAO,wBAEPC,KAAM,KACNC,cAAe,KACfC,MAAO,KACPC,eAAgB,KAChBC,IAAK,KACLC,aAAc,KACdC,MAAO,MC1HT,MAAMC,EAAqB,CACzBC,MAAO,uBACPC,MAAO,oCACPC,MAAO,4CACPC,MAAO,oCACPC,MAAO,2BCPT,SAASC,EAAaC,GACpB,OAAiC,IAAzBA,EAASA,EAAQ,GCE3B,MAAMC,EAAe,GAYrB,SAASC,EAAeC,GACtB,IAAIC,EACAC,EAAMF,EAAQ,GAClB,IAAK,IAAIG,EAAI,EAAGA,EAAIH,EAAQI,OAAQD,IAClCD,EAAMG,KAAKH,IAAIA,EAAKF,EAAQG,IAW9B,OAPEF,EADEC,GAAO,IACKI,EAActB,cACnBkB,GAAO,MACFI,EAAcpB,eAEdoB,EAAclB,aAGvBa,EAGT,SAASM,EAAavI,EAAIwI,EAAcC,EAAQC,GAC9C,MAAMC,EAAS3I,EAAGuI,eAIlB,OAHAvI,EAAG4I,WAAWJ,EAAcG,GAC5B3I,EAAG6I,WAAWL,EAAcC,EAAQC,GACpC1I,EAAG4I,WAAWJ,EAAc,MACrBG,EAGT,SAASG,EAAsB9I,EAAI+I,EAAmBL,GACpD,IAAIM,EAAY,GAChB,IAAK,MAAMC,KAAWF,EAAmB,CACvC,GAAIC,EAAUZ,OAAS,IAAM,MAC7BY,GAAa,GAAGC,EAAQC,QAAQ,MAElC,IAOIC,EAPAR,EAASb,EAAakB,GAC1B,GAAIL,EACF,OAAOA,EAMT,GAHAD,EAAQvJ,EAAauJ,EAAO1I,EAAGoJ,aAG3BC,MAAMC,QAAQP,GAChBI,EAAa,IAAII,aAAaR,OACzB,CAAA,MApDkBlB,EAoDIkB,aAnDLQ,cACjB1B,aAAiB2B,YACjB3B,aAAiB4B,aACjB5B,aAAiB6B,aACjB7B,aAAiB8B,WACjB9B,aAAiB+B,YACjB/B,aAAiBgC,YAgDtB,MAAM,IAAI1J,MAAM,cAAgB4I,EAAoB,gCAFpDI,EAAaJ,EArDjB,IAA2BlB,EA4DzB,OAFAc,EAASJ,EAAavI,EAAIA,EAAG8J,aAAcX,EAAYT,GACvDZ,EAAakB,GAAaL,EACnBA,EAGT,SAASoB,EAAoB/J,EAAI+I,EAAmBL,GAClD,MAAMM,EAAYD,EAAkBiB,WACpC,IAOIb,EAPAR,EAASb,EAAakB,GAC1B,GAAIL,EACF,OAAOA,EAGTD,EAAQvJ,EAAauJ,EAAO1I,EAAGoJ,aAG/B,MAAMnB,EAAcF,EAAegB,GAEnC,GAAId,IAAgBjI,EAAGgH,cAErBmC,EAAa,IAAIK,WAAWT,QAEvB,GAAId,IAAgBjI,EAAGkH,eAE5BiC,EAAa,IAAIM,YAAYV,OAExB,CAAA,GAAId,IAAgBjI,EAAGoH,aAM5B,MAAM,IAAIjH,MAAM,4CAJhBgJ,EAAa,IAAIO,YAAYX,GAC7B/I,EAAGiK,aAAa,0BAUlB,OAJAtB,EAASJ,EAAavI,EAAIA,EAAGkK,qBAAsBf,EAAYT,GAE/DC,EAAOV,YAAcA,EACrBH,EAAakB,GAAaL,EACnBA,EC7DT,SAASwB,EAAUnK,EAAIoK,GACrB,IAAKpK,EAAGqK,kBAAmB,OAE3B,MAAMC,EAAStK,EAAGuK,aAAavK,EAAGwK,sBAE5BC,EAAMzK,EAAGqK,oBACfrK,EAAG0K,gBAAgBD,GAEnB,MAAME,EAAaP,EAAQO,WACrB3C,EAAUoC,EAAQpC,QAExB,IAAK,MAAM4C,KAAiBD,EAC1B,GAAIpL,OAAOsL,eAAeC,KAAKH,EAAYC,GAAgB,CACzD,MAAMG,SAAEA,EAAQC,KAAEA,EAAIC,KAAEA,GAASN,EAAWC,GAEtCjC,EAASG,EAAsB9I,EAAIgL,EAAMhL,EAAGoJ,aAElDpJ,EAAG4I,WAAW5I,EAAG8J,aAAcnB,GAC/B3I,EAAGkL,wBAAwBH,GAG3B,MAAMI,EAAOnL,EAAGqH,MACV+D,GAAa,EACbC,EAAS,EACTC,EAAS,EACftL,EAAGuL,oBAAoBR,EAAUE,EAAME,EAAMC,EAAYC,EAAQC,GAIrE,GAAI3L,EAAQqI,GAAU,CACpB,MAAMwD,EAAgBzB,EAAoB/J,EAAIgI,EAAShI,EAAGoJ,aAC1DpJ,EAAG4I,WAAW5I,EAAGkK,qBAAsBsB,GAKzC,OAFAxL,EAAG0K,gBAAgBJ,GAEZG,EChET,MAAMgB,EAAgB,GAChBC,EAAiB,GAEvB,SAASC,EAA4BR,GACnC,IAAIS,EAAqB,EAEzB,OAAQT,GACR,KAAK,KACHS,EAAqB,EACrB,MACF,KAAK,MACHA,EAAqB,EACrB,MACF,KAAK,MACHA,EAAqB,EACrB,MACF,KAAK,MAGL,KAAK,MACHA,EAAqB,EACrB,MACF,KAAK,MACHA,EAAqB,EACrB,MACF,KAAK,MACHA,EAAqB,GACrB,MACF,QACE,MAAM,IAAIzL,MAAM,eAAiBgL,EAAO,UAE1C,OAAOS,EAGT,SAASC,EAAiBC,GACxB,MAAMC,KAAEA,EAAId,KAAEA,EAAIE,KAAEA,GAASW,EAE7B,OAAOb,EADgBU,EAA4BR,GAIrD,MAAMa,EAAW,SCzCH,CACZC,cVKF,SAAuBC,GAGrB,IAUIlM,EAVAmM,GAFJD,EAAiB/M,EAAa+M,EAAgB/M,EAAaG,eAE/B6M,OAkB5B,GAjBKA,IACHA,EAAS1M,EAAO2M,SAASC,cAAc,UACvCF,EAAOG,MAAMC,MAAQ,QACrBJ,EAAOG,MAAME,OAAS,QACtBL,EAAOG,MAAMG,YAAY,UAAW,SACpCN,EAAOI,MAAQ7M,OAAOgN,WACtBP,EAAOK,OAAS9M,OAAOiN,aAKvB3M,EADEkM,EAAeU,cACZT,EAAOU,WAAW,SAAUX,GAE5BC,EAAOU,WAAW,QAASX,IAI7BlM,EAAGqK,kBAAmB,CACzB,MAAMyC,EAAS9M,EAAGiK,aAAa,2BAC3B6C,IACF9M,EAAGqK,kBAAoByC,EAAOC,qBAAqBC,KAAKF,GACxD9M,EAAG0K,gBAAkBoC,EAAOG,mBAAmBD,KAAKF,GACpD9M,EAAGkN,kBAAoBJ,EAAOK,qBAAqBH,KAAKF,GACxD9M,EAAGoN,cAAgBN,EAAOO,iBAAiBL,KAAKF,GAChD9M,EAAGwK,qBAAuBsC,EAAOQ,0BAKrC,IAAKtN,EAAGuN,oBAAqB,CAC3B,MAAMC,EAAqBxN,EAAGiK,aAAa,0BACvCuD,IACFxN,EAAGuN,oBAAsBC,EAAmBC,yBAAyBT,KAAKQ,GAC1ExN,EAAG0N,sBAAwBF,EAAmBG,2BAA2BX,KAAKQ,GAC9ExN,EAAG4N,oBAAsBJ,EAAmBK,yBAAyBb,KAAKQ,GAC1ExN,EAAG8N,4BAA8BN,EAAmBO,mCAKxD,IAAK/N,EAAGgO,YAAa,CACnB,MAAMC,EAAiBjO,EAAGiK,aAAa,sBACvC,GAAIgE,EAAgB,CAClBjO,EAAGgO,YAAcC,EAAeC,iBAAiBlB,KAAKiB,GACtD,IAAK,IAAI9F,EAAI,EAAGA,GAAK,GAAIA,IACvBnI,EAAG,mBAAmBmI,KAAO8F,EAAe,mBAAmB9F,WAC/DnI,EAAG,cAAcmI,KAAO8F,EAAe,cAAc9F,WAGvDnI,EAAGmO,sBAAwBF,EAAeG,4BAC1CpO,EAAGqO,iBAAmBJ,EAAeK,uBACrCtO,EAAGqO,iBAAmBJ,EAAeK,wBAKzC,IAAKtO,EAAGuO,2BAA4B,CAClC,MAAMC,EAA8BxO,EAAGiK,aAAa,kCAChDuE,IACFxO,EAAGuO,2BAA6BC,EAA4BC,+BAC5DzO,EAAG0O,uBAAyBF,EAA4BG,4BAI5D,IAAK3O,EAAG4O,IAAK,CACX,MAAMC,EAAiB7O,EAAGiK,aAAa,oBACnC4E,IACF7O,EAAG4O,IAAMC,EAAeC,QACxB9O,EAAG+O,IAAMF,EAAeG,SAI5B,IAAKhP,EAAGiP,gCAAiC,CACvC,MAAMC,EAAyBlP,EAAGiK,aAAa,4BAC3CiF,IACFlP,EAAGiP,gCAAkCC,EAAuBC,qCAIhE,IAAKnP,EAAGoP,kBAAmB,CACzB,MAAMC,EAAkBrP,EAAGiK,aAAa,uBACpCoF,IACFrP,EAAGoP,kBAAoBC,EAAgBC,yBAI3C,IAAKtP,EAAGuP,WAAY,CAClB,MAAMC,EAAsBxP,EAAGiK,aAAa,0BACxCuF,IACFxP,EAAGuP,WAAaC,EAAoBC,gBAyBxC,OApBAzP,EAAG0P,QAAU1P,EAAGiK,aAAa,iCAC7BjK,EAAG2P,SAAW3P,EAAGiK,aAAa,kCAC9BjK,EAAG4P,QAAU5P,EAAGiK,aAAa,iCAC7BjK,EAAG6P,OAAS7P,EAAGiK,aAAa,+BAC5BjK,EAAG8P,QAAU9P,EAAGiK,aAAa,gCAC7BjK,EAAG+P,OAAS/P,EAAGiK,aAAa,gCAE5BjK,EAAGgQ,gBAAkBhQ,EAAGiK,aAAa,uBAErCjK,EAAGiQ,oBAAsBjQ,EAAGiK,aAAa,0BACzCjK,EAAGkQ,aAAelQ,EAAGiK,aAAa,kBAClCjK,EAAGmQ,gBAAkBnQ,EAAGiK,aAAa,qBACrCjK,EAAGoQ,sBAAwBpQ,EAAGiK,aAAa,4BAE3CjK,EAAGqQ,oBAAsBrQ,EAAGiK,aAAa,0BACzCjK,EAAGsQ,wBAA0BtQ,EAAGiK,aAAa,+BAC7CjK,EAAGuQ,cAAgBvQ,EAAGiK,aAAa,mBAEnCjK,EAAGwQ,oBAAsBxQ,EAAGiK,aAAa,0BAElCjK,GU1HPyQ,SP2Ba,SAAkBzQ,EAAIM,GACnC,MAAMoQ,UAAEA,EAASC,YAAEA,EAAWC,UAAEA,EAASC,KAAEA,EAAIC,MAAEA,EAAKC,SAAEA,EAAQC,QAAEA,EAAOC,cAAEA,EAAaC,eAAEA,EAAcC,OAAEA,GAAW7Q,EAErH,GAAIuQ,EAAM,CACJA,EAAKO,OACPpR,EAAGoR,OAAOpR,EAAGqR,WAEbrR,EAAGsR,QAAQtR,EAAGqR,WAGhB,MAAMhR,EAAOwQ,EAAKxQ,MAAQwQ,EAAKxQ,KAAKP,cACvB,SAATO,GAA4B,UAATA,GAA6B,mBAATA,GACzCL,EAAGuR,SAASvR,EAAGK,IAGjB,IAAImR,EAAY7R,EAAQkR,EAAKW,YAAcX,EAAKW,UAAU1R,cACxC,QAAd0R,GAAqC,OAAdA,GACzBxR,EAAGwR,UAAUxR,EAAGwR,IAIpB,GAAId,EAAW,CAOb,IANyB,IAArBA,EAAUU,OACZpR,EAAGoR,OAAOpR,EAAGyR,aACiB,IAArBf,EAAUU,QACnBpR,EAAGsR,QAAQtR,EAAGyR,YAGZf,EAAUjQ,KAAM,CAClB,MAAMA,EAAOiQ,EAAUjQ,KAAKX,cAC5BE,EAAG0R,UAAU1R,EAAGS,KAGM,IAApBiQ,EAAUiB,MACZ3R,EAAG4R,WAAU,IACgB,IAApBlB,EAAUiB,OACnB3R,EAAG4R,WAAU,GAIjB,GAAIjB,EAAa,EACY,IAAvBA,EAAYS,OACdpR,EAAGoR,OAAOpR,EAAG6R,eACmB,IAAvBlB,EAAYS,QACrBpR,EAAGsR,QAAQtR,EAAG6R,cAYhB,MAAMC,MAAEA,EAAKC,KAAEA,GAASpB,EACpBmB,GACF1R,EAA0BJ,EAAIA,EAAGgS,MAAOF,GAEtCC,GACF3R,EAA0BJ,EAAIA,EAAGiS,KAAMF,GAQ3C,GAJInB,GACF5Q,EAAG4Q,UAAUA,EAAU,GAAIA,EAAU,GAAIA,EAAU,GAAIA,EAAU,IAG/DE,EAAO,CAWT,IAVqB,IAAjBA,EAAMM,OACRpR,EAAGoR,OAAOpR,EAAGkS,QACa,IAAjBpB,EAAMM,QACfpR,EAAGsR,QAAQtR,EAAGkS,OAGZpB,EAAMqB,YACRnS,EAAGmS,cAAcrB,EAAMqB,YAGrBrB,EAAMsB,sBAAuB,CAC/B,MAAMC,IAAEA,EAAGC,MAAEA,GAAUxB,EAAMsB,sBAC7B,IAAKzS,EAAQ0S,KAAS1S,EAAQ2S,GAC5B,MAAM,IAAInS,MAAM,gEAElB,MAAMoS,EAAMF,EAAIvS,cACV0S,EAAQF,EAAMxS,cAEd2S,EAAQzS,EAAGuS,GACXG,EAAU1S,EAAGwS,GACnB,IAAK7S,EAAQ8S,GACX,MAAM,IAAItS,MAAM,MAAQoS,EAAM,kBAEhC,IAAK5S,EAAQ+S,GACX,MAAM,IAAIvS,MAAM,MAAQqS,EAAQ,kBAGlCxS,EAAGoS,sBAAsBK,EAAOC,QAC3B,GAAI5B,EAAM6B,cAAe,CAC9B,MAAMC,EAAe9B,EAAM6B,cAAc7S,cACnC+S,EAAW7S,EAAG4S,GACpB,IAAKjT,EAAQkT,GACX,MAAM,IAAI1S,MAAMyS,EAAe,gBAGjC5S,EAAG2S,cAAcE,GAGnB,MAAMC,EAAoBhC,EAAMgC,kBAChC,GAAInT,EAAQmT,GAAoB,CAC9B,MAAMC,OAAEA,EAAMC,OAAEA,EAAMC,SAAEA,EAAQC,SAAEA,GAAaJ,EAC/C,IAAKnT,EAAQoT,GACX,MAAM,IAAI5S,MAAM,8DAElB,IAAKR,EAAQqT,GACX,MAAM,IAAI7S,MAAM,8DAElB,IAAKR,EAAQsT,GACX,MAAM,IAAI9S,MAAM,gEAElB,IAAKR,EAAQuT,GACX,MAAM,IAAI/S,MAAM,gEAGlB,MAAMgT,EAASJ,EAAOjT,cAChBsT,EAASJ,EAAOlT,cAChBuT,EAAWJ,EAASnT,cACpBwT,EAAWJ,EAASpT,cAEpByT,EAAWxT,EAA6BC,EAAImT,GAC5CK,EAAWzT,EAA6BC,EAAIoT,GAC5CK,EAAa1T,EAA6BC,EAAIqT,GAC9CK,EAAa3T,EAA6BC,EAAIsT,GAEpDtT,EAAG8S,kBAAkBS,EAAUC,EAAUC,EAAYC,QAChD,GAAI/T,EAAQmR,EAAM6C,WAAY,CACnC,MAAMC,EAAc9C,EAAM6C,UAAU,GAAG7T,cACjC+T,EAAc/C,EAAM6C,UAAU,GAAG7T,cACjCgU,EAAM/T,EAA6BC,EAAI4T,GACvCG,EAAMhU,EAA6BC,EAAI6T,GAC7C7T,EAAG2T,UAAUG,EAAKC,IAQtB,GAJIhD,GACF/Q,EAAG+Q,SAASA,EAAS,GAAIA,EAAS,GAAIA,EAAS,GAAIA,EAAS,IAG1DC,EAAS,EACY,IAAnBA,EAAQI,OACVpR,EAAGoR,OAAOpR,EAAGgU,eACe,IAAnBhD,EAAQI,QACjBpR,EAAGsR,QAAQtR,EAAGgU,cAEhB,MAAMC,EAAOjD,EAAQiD,KACjBA,GACFjU,EAAGgR,QAAQiD,EAAK,GAAIA,EAAK,GAAIA,EAAK,GAAIA,EAAK,IAoB/C,GAdItU,EAAQsR,MACmB,IAAzBA,EAAcG,OAChBpR,EAAGoR,OAAOpR,EAAGkU,sBACqB,IAAzBjD,EAAcG,OACvBpR,EAAGsR,QAAQtR,EAAGkU,qBAEdC,QAAQC,KAAK,iEAAmEnD,EAAcG,OAAOpH,WAAa,KAKpHhK,EAAGiR,cAAcA,EAAcoD,OAAQpD,EAAcqD,QAGnD3U,EAAQuR,GAAiB,CAC3B,MAAMqD,gBAAEA,EAAe1M,MAAEA,EAAK2M,OAAEA,EAAMpD,OAAEA,GAAWF,GAE3B,IAApBqD,EACFvU,EAAGoR,OAAOpR,EAAGyU,2BACgB,IAApBF,GACTvU,EAAGsR,QAAQtR,EAAGyU,2BAGD,IAAXrD,EACFpR,EAAGoR,OAAOpR,EAAG0U,kBACO,IAAXtD,GACTpR,EAAGsR,QAAQtR,EAAG0U,iBAGZ/U,EAAQkI,IAAUlI,EAAQ6U,MACb,IAAXA,IAA8B,IAAXA,GACrBL,QAAQC,KAAK,0CAEfpU,EAAGkR,eAAerJ,EAAO2M,IAIzB7U,EAAQwR,MACK,IAAXA,EACFnR,EAAGoR,OAAOpR,EAAG2U,SACO,IAAXxD,EACTnR,EAAGsR,QAAQtR,EAAG2U,QAEdR,QAAQC,KAAK,6EOvOjBQ,SCZa,SAAkB5U,GAE/B,MAAM6U,EAAkB7U,EAAGuK,aAAavK,EAAGqR,WACrCyD,EAAe9U,EAAGuK,aAAavK,EAAG+U,gBAGlCC,EAAmBhV,EAAGuK,aAAavK,EAAGyR,YACtCwD,EAAkBjV,EAAGuK,aAAavK,EAAGkV,mBACrCxD,EAAY1R,EAAGuK,aAAavK,EAAGmV,YAC/BC,EAAiBpV,EAAGuK,aAAavK,EAAGqV,iBACpCC,EAAatV,EAAGuK,aAAavK,EAAGuV,aAChCC,EAAYxV,EAAGuK,aAAavK,EAAGyV,YAE/BC,EAAqB1V,EAAGuK,aAAavK,EAAG6R,cACxC8D,EAAoB3V,EAAGuK,aAAavK,EAAG4V,qBAEvCC,EAAa7V,EAAGuK,aAAavK,EAAG8V,aAChCC,EAAc/V,EAAGuK,aAAavK,EAAGgW,cACjCC,EAAcjW,EAAGuK,aAAavK,EAAGkW,cACjCC,EAAuBnW,EAAGuK,aAAavK,EAAGoW,yBAC1CC,EAAuBrW,EAAGuK,aAAavK,EAAGsW,yBAC1CC,EAAmBvW,EAAGuK,aAAavK,EAAGwW,oBACtCC,EAAmBzW,EAAGuK,aAAavK,EAAG0W,mBAEtCC,EAAiB3W,EAAGuK,aAAavK,EAAG4W,kBACpCC,EAAkB7W,EAAGuK,aAAavK,EAAG8W,mBAErCC,EAAkB/W,EAAGuK,aAAavK,EAAGgX,mBACrCC,EAA2BjX,EAAGuK,aAAavK,EAAGkX,8BAC9CC,EAA2BnX,EAAGuK,aAAavK,EAAGoX,8BAC9CC,EAAuBrX,EAAGuK,aAAavK,EAAGsX,yBAC1CC,EAAuBvX,EAAGuK,aAAavK,EAAGwX,wBAE1CC,EAAczX,EAAGuK,aAAavK,EAAG0X,cAGjCC,EAAc3X,EAAGuK,aAAavK,EAAGkS,OAEjCC,EAAanS,EAAGuK,aAAavK,EAAG4X,aAEhCC,EAAc7X,EAAGuK,aAAavK,EAAG8X,eACjCC,EAAgB/X,EAAGuK,aAAavK,EAAGgY,iBACnCC,EAAcjY,EAAGuK,aAAavK,EAAGkY,eACjCC,EAAgBnY,EAAGuK,aAAavK,EAAGoY,iBAEnCC,EAAmBrY,EAAGuK,aAAavK,EAAGsY,oBACtCC,EAAqBvY,EAAGuK,aAAavK,EAAGwY,sBAGxCC,EAAkBzY,EAAGuK,aAAavK,EAAG0Y,UACrCC,EAAkB3Y,EAAGuK,aAAavK,EAAG4Y,mBAErCC,EAAoB7Y,EAAGuK,aAAavK,EAAGgU,cACvC8E,EAAa9Y,EAAGuK,aAAavK,EAAG+Y,aAGhCC,EAA0BhZ,EAAGuK,aAAavK,EAAGkU,qBAC7C+E,EAAsBjZ,EAAGuK,aAAavK,EAAGkZ,uBACzCC,EAAqBnZ,EAAGuK,aAAavK,EAAGoZ,sBAExCC,EAAerZ,EAAGuK,aAAavK,EAAG2U,QAGlC2E,EAAUtZ,EAAGuK,aAAavK,EAAGuZ,UAC7BC,EAAYxZ,EAAGuK,aAAavK,EAAGyZ,YAC/BC,EAAW1Z,EAAGuK,aAAavK,EAAG2Z,WAC9BC,EAAY5Z,EAAGuK,aAAavK,EAAG6Z,YAC/BC,EAAe9Z,EAAGuK,aAAavK,EAAG+Z,eAElCC,EAAwBha,EAAGuK,aAAavK,EAAGia,0BAC3CC,EAAwBla,EAAGuK,aAAavK,EAAGma,0BAG3CC,EAAiBpa,EAAGuK,aAAavK,EAAGqa,iBACpCC,EAAkBta,EAAGuK,aAAavK,EAAGua,mBAGrCC,EAAgBxa,EAAGuK,aAAavK,EAAGya,gBAEnCC,EAAuB1a,EAAGuK,aAAavK,EAAG2a,yBAE1CC,GAA+B5a,EAAGuK,aAAavK,EAAG6a,kCAClDC,GAAiB9a,EAAGuK,aAAavK,EAAG+a,kBACpCC,GAAwBhb,EAAGuK,aAAavK,EAAGib,2BAC3CC,GAAuBlb,EAAGuK,aAAavK,EAAGmb,uBAG1CC,GAAmBpb,EAAGuK,aAAavK,EAAGqb,oBAEtCC,GAA6Btb,EAAGuK,aAAavK,EAAGub,gCAChDC,GAA0Bxb,EAAGuK,aAAavK,EAAGyb,4BAC7CC,GAAoB1b,EAAGuK,aAAavK,EAAG2b,qBAGvCC,GAAgB5b,EAAGuK,aAAavK,EAAG6b,gBACnCC,GAAkB9b,EAAGuK,aAAavK,EAAG+b,kBACrCC,GAAkChc,EAAGuK,aAAavK,EAAGic,oCACrDC,GAAmBlc,EAAGuK,aAAavK,EAAGmc,qBACtCC,GAA8Bpc,EAAGuK,aAAavK,EAAGqc,gCAGjDC,GAAStc,EAAGuK,aAAavK,EAAGuc,QAC5BC,GAAUxc,EAAGuK,aAAavK,EAAGyc,SAG7BC,GAA2B1c,EAAGuK,aAAavK,EAAG2c,4BAG9CC,GAAiB5c,EAAGuK,aAAavK,EAAG6c,iBACpCC,GAAqB9c,EAAGuK,aAAavK,EAAG+c,sBACxCC,GAA4Bhd,EAAGuK,aAAavK,EAAGid,8BAC/CC,GAAqBld,EAAGuK,aAAavK,EAAGmd,qBACxCC,GAAsBpd,EAAGuK,aAAavK,EAAGqd,sBACzCC,GAAmBtd,EAAGuK,aAAavK,EAAGud,oBACtCC,GAAwBxd,EAAGuK,aAAavK,EAAGyd,0BAC3CC,GAAW1d,EAAGuK,aAAavK,EAAG2d,UAG9BC,GAAU5d,EAAGuK,aAAavK,EAAG6d,SAC7BC,GAAgB9d,EAAGuK,aAAavK,EAAG+d,gBACnCC,GAAwBhe,EAAGuK,aAAavK,EAAGyU,0BAC3CwJ,GAAuBje,EAAGuK,aAAavK,EAAGke,wBAC1CC,GAAwBne,EAAGuK,aAAavK,EAAGoe,uBAE3CC,GAAiBre,EAAGuK,aAAavK,EAAGse,YAEpCC,GAAYve,EAAGuK,aAAavK,EAAGwe,YAE/BC,GAAqBze,EAAGuK,aAAavK,EAAG0e,sBAExCC,GAAyB3e,EAAGuK,aAAavK,EAAG4e,0BAGlD,MAAO,CACLrN,SAAU,CACRF,UAAWwD,EACXE,eAAgB7T,EAAc4T,IAEhC+J,MAAO,CACLpN,WAAYuD,EACZE,kBAAmBD,EACnBE,WAAYjU,EAAcwQ,GAC1B2D,gBAAiBD,EACjBG,YAAaD,EACbG,WAAYD,GAEdsJ,QAAS,CACPjN,aAAc6D,EACdE,oBAAqBD,EACrB+B,aAAcD,EACd3F,MAAO,CACLgE,YAAaD,EACbG,aAAc9U,EAAc6U,GAC5BG,aAAchV,EAAc+U,GAC5BG,wBAAyBlV,EAAciV,GACvCG,wBAAyBpV,EAAcmV,GACvCG,mBAAoBuI,OAAOxI,GAAkBvM,SAAS,IACtD0M,kBAAmBqI,OAAOtI,GAAkBzM,SAAS,KAEvD+H,KAAM,CACJ6E,iBAAkBD,EAClBG,kBAAmB5V,EAAc2V,GACjCG,kBAAmB9V,EAAc6V,GACjCG,6BAA8BhW,EAAc+V,GAC5CG,6BAA8BlW,EAAciW,GAC5CG,wBAAyByH,OAAO1H,GAAsBrN,SAAS,IAC/DwN,uBAAwBuH,OAAOxH,GAAsBvN,SAAS,MAGlE8G,MAAO,CACLoB,MAAOyF,EACPC,YAAazF,EACb2F,cAAe5W,EAAc2W,GAC7BG,gBAAiB9W,EAAc6W,GAC/BG,cAAehX,EAAc+W,GAC7BG,gBAAiBlX,EAAciX,GAC/BG,mBAAoBpX,EAAcmX,GAClCG,qBAAsBtX,EAAcqX,IAEtCxH,SAAU,CACR2H,SAAUD,EACVG,kBAAmBD,GAErB3H,QAAS,CACPgD,aAAc6E,EACdE,YAAaD,GAEf7H,cAAe,CACbiD,oBAAqB8E,EACrBE,sBAAuBD,EACvBG,qBAAsBD,GAExBxE,OAAQ0E,EAER2F,QAAS,CACPjC,qBAAsBD,GACtBG,6BAA8BD,GAC9BH,gBAAiBD,GACjBO,oBAAqBD,GACrBG,qBAAsBD,GACtBG,mBAAoBD,GACpB2B,qBAAsBzB,IAExBG,SAAUD,GAEVwB,MAAO,CACL3F,SAAUD,EACVG,WAAYD,EACZG,UAAWD,EACXG,WAAYD,EACZG,cAAeD,EACfS,kBAAmBD,EACnBD,gBAAiBD,GAEnB+E,aAAc,CACZlF,yBAA2BD,EAC3BG,yBAA0BD,GAE5BkF,QAAS,CACPzE,wBAAyBD,EACzBG,iCAAkCD,GAClCH,eAAgBvZ,EAAcsZ,GAC9BO,iBAAkBD,GAClBG,0BAA2BD,GAC3BG,sBAAuBD,IAEzByB,2BAA4BtT,MAAMgW,KAAK3C,IAA0B4C,KAAIC,GAAUre,EAAcqe,KAG7Fb,qBAAsBxd,EAAcud,IACpCD,WAAYD,GACZD,WAAYpd,EAAcmd,IAE1BO,yBAA0BD,GAC1Ba,OAAQ,CACNnE,mBAAoBD,GACpBG,+BAAgCD,GAChCG,2BAA4BD,GAC5BG,oBAAqBD,IAEvB+D,OAAQ,CACN5B,QAASD,GACTG,eAAgBD,GAChBrJ,yBAA0BuJ,GAC1BI,sBAAuBD,GACvBD,uBAAwBD,IAE1ByB,OAAQ,CACN7D,eAAgBD,GAChBG,iBAAkBD,GAClBK,oBAAqBD,GACrBG,+BAAgCD,GAChCH,mCAAoC/a,EAAc8a,KAEpDO,OAAQD,GACRG,QAASD,KDlPXmD,MEHF,SAAe3f,EAAIoK,GACjBA,EAAUjL,EAAaiL,EAASjL,EAAaG,cAC7C,MAAMsgB,GAAEA,EAAEV,MAAEA,EAAKL,MAAEA,EAAKC,QAAEA,GAAY1U,EAEtCpK,EAAG6f,gBAAgB7f,EAAG8f,YAAaF,GAEnC,IAAIG,EAAO,EACPb,IACFlf,EAAGggB,WAAWd,EAAM,GAAIA,EAAM,GAAIA,EAAM,GAAIA,EAAM,IAClDa,GAAQ/f,EAAGigB,kBAETtgB,EAAQkf,KACV7e,EAAGkgB,WAAWrB,GACdkB,GAAQ/f,EAAGmgB,kBAETrB,IACF9e,EAAGogB,aAAatB,GAChBiB,GAAQ/f,EAAGqgB,oBAGA,IAATN,GACF/f,EAAG2f,MAAMI,IFjBXO,KDoEF,SAActgB,EAAIoK,GAChB,MAAMO,WACJA,EAAU3C,QACVA,EAAOyC,IACPA,EACA8V,GAAIC,EACJC,GAAIC,EAAQC,mBACZA,EAAkBf,GAClBA,GACExV,EAEJ,IAAIwW,EAAQxW,EAAQwW,MAIpB,IAHKjhB,EAAQihB,IAAUjhB,EAAQqI,KAC7B4Y,EAAQ5Y,EAAQI,SAEbzI,EAAQihB,GACX,MAAM,IAAIzgB,MAAM,6CAGlB,GAAIR,EAAQ8K,KAAS9K,EAAQghB,GAC3B,MAAM,IAAIxgB,MAAM,oDAGlB,MAAM0gB,EAAgB1hB,EAAaiL,EAAQyW,cAAe7gB,EAAG8gB,WACvDC,EAAW5hB,EAAaiL,EAAQ2W,SAAU5hB,EAAaG,cAE7DU,EAAG6f,gBAAgB7f,EAAG8f,YAAaF,GAEnC,MAAMoB,EAAMR,EAAWE,EACvB,IAAIO,EAAUxV,EAAcuV,GACvBC,IACHA,EPvGJ,SAAuBjhB,EAAIkhB,EAAoBC,EAAsBR,GACnE,MAAMJ,EAAKvgB,EAAGohB,aAAaphB,EAAGqhB,eAC9BrhB,EAAGshB,aAAaf,EAAIW,GACpBlhB,EAAGuhB,cAAchB,GAEjB,MAAME,EAAKzgB,EAAGohB,aAAaphB,EAAGwhB,iBAC9BxhB,EAAGshB,aAAab,EAAIU,GACpBnhB,EAAGuhB,cAAcd,GAEjB,MAAMQ,EAAUjhB,EAAGyhB,gBAQnB,GAPAzhB,EAAG0hB,aAAaT,EAASV,GACzBvgB,EAAG0hB,aAAaT,EAASR,GAEzBzgB,EAAG2hB,aAAapB,GAChBvgB,EAAG2hB,aAAalB,GAGZ9gB,EAAQghB,GACV,IAAK,MAAM/V,KAAiB+V,EAC1B,GAAIphB,OAAOsL,eAAeC,KAAK6V,EAAoB/V,GAAgB,CACjE,MAAMG,EAAW4V,EAAmB/V,GACpC5K,EAAG4hB,mBAAmBX,EAASlW,EAAUH,GAK/C5K,EAAG6hB,YAAYZ,GAEf,IAAIa,EAAM,GAgBV,OAfK9hB,EAAG+hB,oBAAoBd,EAASjhB,EAAGgiB,eACjChiB,EAAGiiB,mBAAmBxB,EAAIzgB,EAAGkiB,kBAChCJ,EAAM9hB,EAAGmiB,iBAAiB1B,GAC1BtM,QAAQiO,MAAM,uCAAyCN,IAGpD9hB,EAAGiiB,mBAAmB1B,EAAIvgB,EAAGkiB,kBAChCJ,EAAM9hB,EAAGmiB,iBAAiB5B,GAC1BpM,QAAQiO,MAAM,qCAAuCN,IAGvDA,EAAM9hB,EAAGqiB,kBAAkBpB,GAC3B9M,QAAQiO,MAAM,4BAA8BN,IAGvCb,EO2DKQ,CAAczhB,EAAIwgB,EAAUE,EAAUC,GAChDlV,EAAcuV,GAAOC,GAGvBjhB,EAAGsiB,WAAWrB,GAGd,MAAMsB,EAAqBviB,EAAG+hB,oBAAoBd,EAASjhB,EAAGwiB,mBAE9D,GAAI7iB,EAAQ8K,GAEVzK,EAAG0K,gBAAgBD,OAEd,CAAA,IAAI9K,EAAQgL,GAoCjB,MAAM,IAAIxK,MAAM,sCApCc,CAC9B,MAAMsiB,EA5EV,SAAmB9X,EAAY3C,GAC7B,IAAIgZ,EAAM,GACV,IAAK,MAAMpW,KAAiBD,EACtBpL,OAAOsL,eAAeC,KAAKH,EAAYC,KAEzCoW,GADkBrW,EAAWC,GACZZ,YAQrB,OAJIhC,IACFgZ,GAAOhZ,EAAQgC,YAGVgX,EA+DU0B,CAAU/X,EAAY3C,GACrC,IAAIyC,EAAMuB,EAASyW,GACnB,IAAKhY,EAAK,CACR,MAAMkY,EAAgB,GACtB,IAAK,IAAIxa,EAAI,EAAGA,EAAIoa,EAAoBpa,IAAK,CAC3C,MAAM2D,EAAkB9L,EAAG4iB,gBAAgB3B,EAAS9Y,GAC9CyC,EAAgBkB,EAAgBC,KAEtC,GAAIxM,OAAOsL,eAAeC,KAAKH,EAAYC,GAAgB,CACzD,MAAMiY,EAAYlY,EAAWC,GACvBkY,EAAiB9iB,EAAG+iB,kBAAkB9B,EAASrW,GAErD,IAAwB,IAApBkY,EACF,SAGF,MAAM7X,EAAOY,EAAiBC,GAC9B6W,EAAc/X,GAAiB,CAC7BG,SAAU+X,EACV7X,KAAMA,EACND,KAAM6X,IAKZpY,EAAMN,EAAUnK,EAAI,CAClB2K,WAAYgY,EACZ3a,QAASA,IAGXgE,EAASyW,GAAUhY,EAGrBzK,EAAG0K,gBAAgBD,IAMrB,MAAMuY,EAAmBhjB,EAAG+hB,oBAAoBd,EAASjhB,EAAGijB,iBACtDC,EAAsBljB,EAAGuK,aAAavK,EAAG2a,yBAC/C,IAAIwI,EAAqB,EACzB,IAAK,IAAIhb,EAAI,EAAGA,EAAI6a,EAAkB7a,IAAK,CACzC,MAAMib,EAAgBpjB,EAAGqjB,iBAAiBpC,EAAS9Y,GACnD,IAAImb,EAAcF,EAAcrX,KAChC,MAAMZ,EAAOiY,EAAcjY,KAC3B,IAAIoY,GAAiB,EAErB,MAAMC,EAAiBF,EAAYG,QAAQ,KAO3C,GANID,GAAkB,IAEpBF,EAAcA,EAAYI,MAAM,EAAGF,GACnCD,GAAiB,GAGfhkB,OAAOsL,eAAeC,KAAKiW,EAAUuC,GAAc,CACrD,MAAMK,EAAU5C,EAASuC,GACnBM,EAAkB5jB,EAAG6jB,mBAAmB5C,EAASqC,GAEvD,GAAwB,OAApBM,EACF,SAIF,GAAIL,EAAgB,CAClB,MAAM3X,EAAqBD,EAA4BR,GAEvDnL,EAAG,UAAY4L,EAAqB,MAAMgY,EAAiBva,MAAMgW,KAAKsE,IACtE,SAGF,MAAMG,SAAuBH,EACvBI,EAAc/jB,EAAGgkB,SAAWb,EAClC,GAAIQ,aAAmBM,aAAc,CAGnC,GAFAjkB,EAAGwa,cAAcuJ,GAEbX,EAAcjY,OAASnL,EAAGkkB,WAC5BlkB,EAAGmkB,YAAYnkB,EAAGokB,WAAYT,QACzB,GAAIP,EAAcjY,OAASnL,EAAGqkB,WACnCrkB,EAAGmkB,YAAYnkB,EAAGskB,WAAYX,OACzB,CAAA,GAAIP,EAAcjY,OAASnL,EAAGukB,aAGnC,MAAM,IAAIpkB,MAAMijB,EAAe,2CAF/BpjB,EAAGmkB,YAAYnkB,EAAGwkB,iBAAkBb,GAKtC3jB,EAAGykB,UAAUb,EAAiBT,GAC9BA,SACK,GIxNQuB,EJwNQf,EItNzBta,MAAMC,QAAQob,IACXA,GACe,iBAATA,GACkB,iBAAjBA,EAAW,SACF,IAAhBA,EAAKtc,QACHsc,EAAKtc,OAAS,GACdsc,EAAKtc,OAAS,KAAMsc,GJgNU,CAC/B,MAAMzZ,EAAO0Y,EAAQvb,OACrB,GAAI6C,GAAQ,EACVjL,EAAG,UAAYiL,EAAO,MAAO2Y,EAAiBD,QACzC,GAAI1Y,GAAQ,GAAI,CACrB,MAAM0Z,EAAQtc,KAAKuc,MAAMvc,KAAKwc,KAAK5Z,IAC7B6Z,GAAY,EAClB9kB,EAAG,gBAAkB2kB,EAAQ,MAAMf,EAAiBkB,EAAWzb,MAAMgW,KAAKsE,UAEvE,GAAIxY,IAASnL,EAAGqH,MACrBrH,EAAG+kB,UAAUnB,EAAiBD,QACzB,GAAIxY,IAASnL,EAAGglB,MAAQ7Z,IAASnL,EAAGmH,IACzCnH,EAAGykB,UAAUb,EAAiBD,QACzB,GAAsB,WAAlBG,EAA4B,CAErC,GAAIX,EAAqBD,EAAqB,CAC5C/O,QAAQiO,MAAM,yCACd,SAGF,IAAIhD,EAAU1T,EAAeiY,GAE7B,IAAKvE,EAAS,CACZA,EAAUpf,EAAGilB,gBACbjlB,EAAGwa,cAAcuJ,GACjB/jB,EAAGmkB,YAAYnkB,EAAGokB,WAAYhF,GAE9Bpf,EAAGklB,cAAcllB,EAAGokB,WAAYpkB,EAAGmlB,eAAgBnlB,EAAGolB,eACtDplB,EAAGklB,cAAcllB,EAAGokB,WAAYpkB,EAAGqlB,eAAgBrlB,EAAGolB,eACtDplB,EAAGklB,cAAcllB,EAAGokB,WAAYpkB,EAAGslB,mBAAoBtlB,EAAGulB,QAC1DvlB,EAAGklB,cAAcllB,EAAGokB,WAAYpkB,EAAGwlB,mBAAoBxlB,EAAGulB,QAE1DvlB,EAAGylB,WAAWzlB,EAAGokB,WAAY,EAAGpkB,EAAG0lB,KAAM,EAAG,EAAG,EAAG1lB,EAAG0lB,KAAM1lB,EAAGgH,cAAe,IAAIwC,WAAW,CAAC,IAAK,IAAK,IAAK,OAC5G,MAAMmc,EAAQ,IAAIC,MAClBD,EAAM7R,IAAM6P,EACZgC,EAAME,iBAAiB,QAAQ,KAC7B7lB,EAAGwa,cAAcuJ,GACjB/jB,EAAGmkB,YAAYnkB,EAAGokB,WAAYhF,GAC9Bpf,EAAGylB,WAAWzlB,EAAGokB,WAAY,EAAGpkB,EAAG0lB,KAAM1lB,EAAG0lB,KAAM1lB,EAAGgH,cAAe2e,MAGtEja,EAAeiY,GAAWvE,EAG5Bpf,EAAGwa,cAAcuJ,GACjB/jB,EAAGmkB,YAAYnkB,EAAGokB,WAAYhF,GAC9Bpf,EAAGykB,UAAUb,EAAiBT,GAE9BA,MIxQR,IAAqBuB,EJ8QnB,MAAMoB,EAA6B9lB,EAAGuK,aAAavK,EAAGid,8BACtD,GAAIjV,GAAWA,EAAQI,OAAS,EAAG,CACjC,MAAMO,EAASoB,EAAoB/J,EAAIgI,EAAShI,EAAGoJ,aACnDpJ,EAAG4I,WAAW5I,EAAGkK,qBAAsBvB,GAEvC,MAAMV,EAAcF,EAAeC,GACnChI,EAAG+lB,aAAalF,EAAeD,EAAO3Y,EAAa,QAC9C,GAAI6d,EAA4B,CACrC,MAAM7d,EAAc6d,EAA2B7d,YAC/CjI,EAAG+lB,aAAalF,EAAeD,EAAO3Y,EAAa,QAEnDjI,EAAGgmB,WAAWnF,EAAe,EAAGD,ICzQlCqE,cIWF,SAAuBjlB,EAAIoK,GACzB,MAAM6b,eAAEA,EAAc9a,KAAEA,EAAIoU,OAAEA,EAAMhT,MAAEA,EAAKC,OAAEA,EAAMxB,KAAEA,EAAIkb,eAAEA,GAAmB9b,EAExEyU,EAAQ1f,EAAaiL,EAAQyU,MAAO,GACpCsH,EAAQhnB,EAAaiL,EAAQ+b,MAAOnmB,EAAGolB,eACvCgB,EAAQjnB,EAAaiL,EAAQgc,MAAOpmB,EAAGolB,eACvCiB,EAAQlnB,EAAaiL,EAAQic,MAAOrmB,EAAGolB,eACvCkB,EAAYnnB,EAAaiL,EAAQkc,UAAWtmB,EAAGulB,QAC/CgB,EAAYpnB,EAAaiL,EAAQmc,UAAWvmB,EAAGulB,QAErD,IAAIiB,EAASpc,EAAQoc,OAChBA,IACHA,EAAS,CAAExb,IAGb,MAAMyb,EAAQtnB,EAAaiL,EAAQqc,OAAO,GACpCC,EAAmBvnB,EAAaiL,EAAQsc,kBAAkB,GAChE1mB,EAAG2mB,YAAY3mB,EAAGmc,oBAAqBsK,GACvCzmB,EAAG2mB,YAAY3mB,EAAGqc,+BAAgCqK,GAElD,MAAMtH,EAAUpf,EAAGilB,gBACb2B,EAAgBznB,EAAaiL,EAAQyc,OAAQ7mB,EAAGokB,YAEtDpkB,EAAGwa,cAAcxa,EAAGgkB,UACpBhkB,EAAGmkB,YAAYyC,EAAexH,GAG1BjU,IAASnL,EAAGqH,QACVrH,aAAc8mB,wBAA0B9mB,EAAGmQ,eAC7CgE,QAAQC,KAAK,iCAGVkS,IAActmB,EAAGulB,QACpBe,IAActmB,EAAG+mB,uBACjBT,IAActmB,EAAGgnB,uBACjBV,IAActmB,EAAGinB,sBAA0BjnB,EAAGoQ,qBAE9C+D,QAAQC,KAAK,gDAIjB,MAAM8S,EAAiBV,EAAOpe,OAC9B,IAAK,IAAI+e,EAAQ,EAAGA,EAAQD,EAAgBC,IAAS,CACnD,MAAMC,EAAYZ,EAAOW,GAEzB,GACEC,aAAqBC,kBACrBD,aAAqBE,mBACrBF,aAAqBG,iBAEjBX,IAAkB5mB,EAAGokB,WACvBpkB,EAAGylB,WAAWzlB,EAAGokB,WAAY+C,EAAOnnB,EAAG0lB,KAAM1lB,EAAG0lB,KAAM1lB,EAAGgH,cAAeogB,GAC7CpnB,EAAGskB,eAI3B,CACL,MAAMkD,EAAS,EACXZ,IAAkB5mB,EAAGokB,WACvBpkB,EAAGylB,WAAWzlB,EAAGokB,WAAY+C,EAAOlB,EAAgB1Z,EAAOC,EAAQgb,EAAQjI,EAAQpU,EAAMic,GAChFR,IAAkB5mB,EAAGskB,aAC9BtkB,EAAGynB,WAAWznB,EAAGskB,WAAY6C,EAAOlB,EAAgB1Z,EAAOC,EAAQqS,EAAO2I,EAAQjI,EAAQpU,EAAMic,GAChGpnB,EAAGklB,cAAc0B,EAAe5mB,EAAG0nB,eAAgBrB,KAoBzD,OAfArmB,EAAGklB,cAAc0B,EAAe5mB,EAAGmlB,eAAgBgB,GACnDnmB,EAAGklB,cAAc0B,EAAe5mB,EAAGqlB,eAAgBe,GACnDpmB,EAAGklB,cAAc0B,EAAe5mB,EAAGslB,mBAAoBgB,GACvDtmB,EAAGklB,cAAc0B,EAAe5mB,EAAGwlB,mBAAoBe,IAEhC,IAAnBL,IACGte,EAAa2E,IAAU3E,EAAa4E,IAAYxM,aAAc2nB,uBACjE3nB,EAAGkmB,eAAeU,GAElBzS,QAAQC,KAAK,+DAAiE7H,EAAQ,IAAMC,EAAS,MAIzGxM,EAAGmkB,YAAYyC,EAAe,MAEvBxH,GJ5FPwI,cKFF,SAAuB5nB,EAAIof,EAAS3W,GAIlC,GAHAzI,EAAGwa,cAAcxa,EAAGgkB,UACpBhkB,EAAGmkB,YAAYnkB,EAAGokB,WAAYhF,GAE1B3W,aAAkB4e,kBACpB5e,aAAkB6e,mBAClB7e,aAAkB8e,iBAClBvnB,EAAGylB,WAAWzlB,EAAGokB,WAAY,EAAGpkB,EAAG0lB,KAAM1lB,EAAG0lB,KAAM1lB,EAAGgH,cAAe6gB,eAC/D,CAEL,MAAMtb,MAAEA,EAAKC,OAAEA,EAAMsb,gBAAEA,GAAoBrf,EACrC0e,EAAQhoB,EAAasJ,EAAO0e,MAAO,GACnClB,EAAiB9mB,EAAasJ,EAAOwd,eAAgBjmB,EAAG0lB,MACxDnG,EAASpgB,EAAasJ,EAAO8W,OAAQvf,EAAG0lB,MACxCva,EAAOhM,EAAasJ,EAAOwd,eAAgBjmB,EAAGgH,eAC9CwgB,EAAS,EAEfxnB,EAAGylB,WAAWzlB,EAAGokB,WAAY+C,EAAOlB,EAAgB1Z,EAAOC,EAAQgb,EAAQjI,EAAQpU,EAAM2c,GAI3F,OADA9nB,EAAGmkB,YAAYnkB,EAAGokB,WAAY,MACvBhF,GLlBP2I,cMjBF,SAAuB/nB,EAAIoK,GACzBA,EAAUjL,EAAaiL,EAASjL,EAAaG,cAC7C,MAAM6nB,EAAQhoB,EAAaiL,EAAQ+c,MAAO,GACpCnc,EAAOZ,EAAQY,KACfuB,EAAQnC,EAAQmC,MAChBC,EAASpC,EAAQoC,OACjB+S,EAASpgB,EAAaiL,EAAQmV,OAAQvf,EAAG0lB,MACzCva,EAAOhM,EAAaiL,EAAQe,KAAMnL,EAAGgH,eACrCif,EAAiB9mB,EAAaiL,EAAQ6b,eAAgBjmB,EAAG0lB,MAEzDtG,EAAUpf,EAAGilB,gBACnBjlB,EAAGwa,cAAcxa,EAAGgkB,UACpBhkB,EAAGmkB,YAAYnkB,EAAGwkB,iBAAkBpF,GAEpC,MAAM4I,EAAQ,CACZ,CACEnB,OAAQ7mB,EAAGioB,4BACXjd,KAAMA,EAAKkd,IAEb,CACErB,OAAQ7mB,EAAGmoB,4BACXnd,KAAMA,EAAKod,IAEb,CACEvB,OAAQ7mB,EAAGqoB,4BACXrd,KAAMA,EAAKsd,IAEb,CACEzB,OAAQ7mB,EAAGuoB,4BACXvd,KAAMA,EAAKwd,IAEb,CACE3B,OAAQ7mB,EAAGyoB,4BACXzd,KAAMA,EAAK0d,IAEb,CACE7B,OAAQ7mB,EAAG2oB,4BACX3d,KAAMA,EAAK4d,KAIf,IAAK,IAAIzgB,EAAI,EAAGA,EAAI,EAAGA,IAAK,CAC1B,MAAM9H,EAAO2nB,EAAM7f,GACb0e,EAASxmB,EAAKwmB,OACdgC,EAAaxoB,EAAK2K,KACpB6d,aAAsBxB,iBACxBrnB,EAAGylB,WAAWoB,EAAQM,EAAOlB,EAAgB1G,EAAQpU,EAAM0d,GAE3D7oB,EAAGylB,WAAWoB,EAAQM,EAAOlB,EAAgB1Z,EAAOC,EAAQ,EAAG+S,EAAQpU,EAAM0d,GAI/E7oB,EAAGklB,cAAcllB,EAAGwkB,iBAAkBxkB,EAAGmlB,eAAgBnlB,EAAGolB,eAC5DplB,EAAGklB,cAAcllB,EAAGwkB,iBAAkBxkB,EAAGqlB,eAAgBrlB,EAAGolB,eAC5DplB,EAAGklB,cAAcllB,EAAGwkB,iBAAkBxkB,EAAGslB,mBAAoBtlB,EAAGulB,QAChEvlB,EAAGklB,cAAcllB,EAAGwkB,iBAAkBxkB,EAAGwlB,mBAAoBxlB,EAAGulB,QAKlE,OAFAvlB,EAAGmkB,YAAYnkB,EAAGwkB,iBAAkB,MAE7BpF,GN1CPjV,UAAAA,EACA2e,kBLXF,SAA2B9oB,EAAIoK,GAC7B,MAAM2e,aAAEA,EAAYC,aAAEA,EAAYC,kBAAEA,GAAsB7e,EACpD8e,EAAmB/pB,EAAaiL,EAAQ8e,iBAAkB,CAAEH,IAE5DnJ,EAAK5f,EAAG8oB,oBACd9oB,EAAG6f,gBAAgB7f,EAAG8f,YAAaF,GAGnC5f,EAAGwa,cAAcxa,EAAGgkB,UACpB,MAAMmF,EAAyBD,EAAiB9gB,OAChD,GAAI+gB,EAAyB,EAAG,CAC9B,MAAMC,EAAMppB,EAAGiK,aAAa,sBACtB+D,EAAc,GACpB,IAAK,IAAI7F,EAAI,EAAGA,EAAIghB,EAAwBhhB,IAC1C6F,EAAYqb,KAAKD,EAAIE,wBAA0BnhB,GAEjDihB,EAAIlb,iBAAiBF,GAErB,IAAK,IAAI7F,EAAI,EAAGA,EAAIghB,EAAwBhhB,IAAK,CAC/C,MAAMohB,EAAkBL,EAAiB/gB,GACzCnI,EAAGmkB,YAAYnkB,EAAGokB,WAAYmF,GAC9BvpB,EAAGwpB,qBAAqBxpB,EAAG8f,YAAa9f,EAAGypB,kBAAoBthB,EAAGnI,EAAGokB,WAAYmF,EAAiB,SAGpGvpB,EAAGmkB,YAAYnkB,EAAGokB,WAAY2E,GAC9B/oB,EAAGwpB,qBAAqBxpB,EAAG8f,YAAa9f,EAAGypB,kBAAmBzpB,EAAGokB,WAAY2E,EAAc,GAK7F,GAHA/oB,EAAGmkB,YAAYnkB,EAAGokB,WAAY,MAG1B4E,EACFhpB,EAAGmkB,YAAYnkB,EAAGokB,WAAY4E,GAC9BhpB,EAAGwpB,qBAAqBxpB,EAAG8f,YAAa9f,EAAG0pB,iBAAkB1pB,EAAGokB,WAAY4E,EAAc,GAC1FhpB,EAAGmkB,YAAYnkB,EAAGokB,WAAY,WAE3B,GAAI6E,EAAmB,CAC1B,MAAMU,EAAe3pB,EAAG4pB,qBACxB5pB,EAAG6pB,iBAAiB7pB,EAAG8pB,aAAcH,GACrC3pB,EAAG+pB,oBAAoB/pB,EAAG8pB,aAAc9pB,EAAGgqB,kBAAmBf,EAAkB1c,MAAO0c,EAAkBzc,QACzGxM,EAAGiqB,wBAAwBjqB,EAAG8f,YAAa9f,EAAG0pB,iBAAkB1pB,EAAG8pB,aAAcH,GACjF3pB,EAAG6pB,iBAAiB7pB,EAAG8pB,aAAc,MAGvC,MAAMI,EAASlqB,EAAGmqB,uBAAuBnqB,EAAG8f,aAC5C,GAAIoK,IAAWlqB,EAAGoqB,qBAChB,MAAM,IAAIjqB,MAAM,kFAAoFmH,EAAmB4iB,GAAU,KAGnI,OAAOtK"}